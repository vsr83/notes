\documentclass [12pt, a4paper] {article}

%Babel tekee kuulemma jotain typer��, joten seuraava on v�ltt�m�t�nt�.
\usepackage[all, knot] {xy}
\let\oldxy\xy\def\xy{\begingroup\catcode`\"12\oldxy}
\let\oldendxy\endxy\def\endxy{\oldendxy\endgroup} 
\xyoption {arc}
\usepackage [latin1] {inputenc}
\usepackage [T1] {fontenc}
\usepackage [english] {babel}
\usepackage [dvips] {graphicx}
\usepackage {amsfonts}
\usepackage {amssymb}
\usepackage {amsmath}
\usepackage {verbatim}
\usepackage {fancyhdr}
\usepackage {psfrag}
\usepackage {listings}
\usepackage {eso-pic}
\usepackage {siunitx}
\usepackage {wasysym}
\usepackage {marvosym}
\usepackage {geometry}
%\usepackage {mathabx}
%\usepackage[urw-garamond]{mathdesign}
\usepackage[small,bf]{caption}
\usepackage{enumitem}
\usepackage{stix}
\usepackage{lipsum}
\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usepackage{hyperref}
\usepackage[dvipsnames]{xcolor}

\newcommand{\BackgroundPic}{
%  \put(0,0){
%    \parbox[b][\paperheight]{\paperwidth}{
%      \vfill
%      \centering
%      \includegraphics[width=\paperwidth, height=\paperheight, keepaspectratio%]{
%kansilehti.ps}
%    }
%  }
%  \textbf{SMG-5156 - Electromagnetic Modelling I}\\
%  \textbf{Exercise 1 - Problem 4}\\
%  \textbf{Ville R�is�nen}
%\end {flushleft}

%  \put(42, 810){\textbf{SMG-5156 - Electromagnetic Modelling I}}
%  \put(42, 797){\textbf{Exercise 1 - Problem 1}}
%  \put(42, 784){\textbf{Ville R�is�nen}}
%  \put(445, 810){\textbf{Please, do not distribute!}}
}

\addtolength{\evensidemargin}{-1cm}
\addtolength{\oddsidemargin}{-1cm}
\addtolength{\marginparwidth}{-2.0cm}
\addtolength{\topmargin}{-2cm}
\addtolength{\textwidth}{3cm}
\addtolength{\textheight}{2cm}
\addtolength{\columnsep}{0.5cm}

 
\lhead {Optical Effects from Observer Motion\\Ville R{\"a}is{\"a}nen (\url{https://www.github.com/vsr83})}
\rhead {\today}
\thispagestyle{fancy}

\newtheorem {problem} {Problem}
\newtheorem {example} {Example}
\newtheorem {theorem} {Theorem}
\newtheorem {definition} {Definition}
\newtheorem {postulate} {Postulate}
\newtheorem {specialcase} {Special Case}

\newcommand{\vu}[1]
{
	\mathbf{\hat #1}
}
\newcommand{\vf}[1]
{
	\mathbf{\vec #1}
}
\newcommand{\mc}[1]
{
	\mathcal{#1}
}
\newcommand{\vc}[1]
{
	\boldsymbol{#1}
}
\newcommand{\vcc}[1]
{
	\widetilde{\boldsymbol{#1}}
}
\newcommand{\cc}[1]
{
	\widetilde{#1}
}
\newcommand{\sgn}
{
  \textrm{sgn}\:
}
\newcommand{\pdiff}[2]
{
	\dfrac{\partial #1}{\partial #2}
}
\newcommand{\diff}[2]
{
	\dfrac{d #1}{d #2}
}
\newcommand{\vali}
{
  \begin {displaymath}\:\end{displaymath}
}
\newcommand{\norm}[2]
{
  ||#1||_{#2}
}

\newcommand{\solution}
{
   {\textbf{\textrm{Solution:}}}
}
\newcommand{\motivation}
{
  {\textbf{\textrm{Motivation:}}}
}

\begin {document}

\tableofcontents

\newpage
\section{Motivation}
This document contains my notes on optical and visual effects resulting from 
observer motion when the speed of light is finite. The discussed effects are 
related to the interplay of aberration, Doppler effect, special relativity
and the human perception of color. My interest on the topic arose from 
attempts to solve fascinating problems in the textbook \cite{relativity_problems}
and implementation of aberration correction algorithms.

\section{Aberration Formulas}
\subsection {Classical and Relativistic Aberration}
\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \draw[thick, color=gray!50] (3.5, 0) -- (4, 0.5);
        \draw[thick, color=gray!50] (3, 0) -- (4, 1);
        \draw[thick, color=gray!50] (3, 0.5) -- (4, 1.5);
        \draw[thick, color=gray!50] (3, 1) -- (4, 2);
        \draw[thick, color=gray!50] (2, 0.5) -- (3.5, 2);
        \draw[thick, color=gray!50] (2.0, 1) -- (3.0, 2);
        \draw[thick, color=gray!50] (1.5, 1) -- (2.5, 2);
        \draw[thick, color=gray!50] (0.0, 0) -- (2.0, 2);
        \draw[thick, color=gray!50] (0.0, 0.5) -- (1.5, 2);
        \draw[thick, color=gray!50] (0.0, 1.0) -- (1.0, 2);
        \draw[thick, color=gray!50] (0.0, 1.5) -- (0.5, 2);

        \draw[thick, color=gray!50] (9.0, 0) -- (10, 0.5);
        \draw[thick, color=gray!50] (8.0, 0) -- (10, 1.0);
        \draw[thick, color=gray!50] (7.0, 0) -- (10, 1.5);
        \draw[thick, color=gray!50] (7.0, 0.5) -- (10, 2);
        \draw[thick, color=gray!50] (6.0, 0.5) -- (9, 2);
        \draw[thick, color=gray!50] (6.0, 1) -- (8, 2);
        \draw[thick, color=gray!50] (6.0, 1.5) -- (7, 2);


        \draw[fill=gray!10] (1,0) rectangle (3,1);
        \draw[thick] (0, 0) -- (4, 0);
        \draw[fill=gray!10] (7,0) rectangle (9,1);
        \draw[thick] (6, 0) -- (10, 0);
        \draw[thick] (8, 0) -- (10, 1);

        \draw[thick, ->] (2, 0) -- (2, 1.5);
        \draw[thick, ->] (2, 0) -- (3.5, 0);
        \draw[thick, ->] (8, 0) -- (8, 1.5);
        \draw[thick, ->] (8, 0) -- (9.5, 0);
        \draw[thick] (2, 0) -- (4, 2);
        \draw[thick] (2.4,0) arc (0:45:0.4);
        \draw[thick] (8.5,0) arc (0:25:0.5);
        \draw (2.6,0.25) node{$\theta$};
        \draw (8.9,0.25) node{$\theta'$};
        \draw[thick, ->] (3, 0.5) -- (4, 0.5);
        \draw (3.5,0.75) node{$v$};

        \draw (1.65,1.25) node{$y$};
        \draw (3.35,-0.35) node{$x$};
        \draw (7.65,1.25) node{$y'$};
        \draw (9.35,-0.305) node{$x'$};


        \draw (0,0.5) node{$S$};
        \draw (6,0.5) node{$S'$};
    \end {tikzpicture}
    \caption{\label{fig:train}Path of the rain drops in a frame fixed to the ground and 
    the train.}
  \end {center}
\end {figure}
Consider a train cart fixed to the frame $S'$ moving in $+x$-direction with velocity 
$v$ w.r.t. frame $S$ fixed to the ground. Passenger on the train observes the direction 
of rain drops from the window. Suppose in $S$ it is raining from direction 
$\theta$ w.r.t. the positive x axis. Then, the path of rain drop falling through $x=y=0$ 
can be written
\begin {eqnarray}
    x(t) &=& -u\cos\theta\:t,\\
    y(t) &=& -u\sin\theta\:t,
\end {eqnarray}
where $u$ is the velocity of the rain drop in $S$. In $S'$, we can express
\begin {eqnarray}
    x'(t) &=& -(u\cos\theta + v)t,\\
    y'(t) &=& -u(\sin\theta)t.
\end {eqnarray}
In $S'$, the angle $\theta'$ made by the rain drops w.r.t. positive x axis can be 
expressed 
\begin {eqnarray}
    \tan\theta' 
    = 
    \frac{y'}{x'} 
    =
    \frac{u\sin\theta}{u\cos\theta + v} 
    =
    \frac{\tan\theta}{1 + \beta\sec\theta},
\end {eqnarray}
where $\beta = v/u$ and $\sec\theta = 1/\cos\theta$. This classical formula is 
limited angles in $+x$ direction. More generally,
\begin {eqnarray}
    \theta' 
    =
    \textrm{atan2}(\sin\theta, \cos\theta + \beta) 
\end {eqnarray}

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.9\columnwidth] {fig/aberration.eps}
     \caption{\label{fig:classicrel}Difference between classical (top) and relativistic 
     (bottom) aberration.}
  \end {center}
\end {figure} 
Consider now light in the context of Special Relativity with velocity vector 
$\vc c = (-c\cos\theta, -c\sin\theta, 0)$. Then, simple application of Lorentz 
transformation, yields 
\begin {eqnarray}
    x' &=& \gamma(x - vt) 
    = -\gamma(c\cos\theta + v) t,
    \\
    y' &=& y = -(c\sin\theta)t,
\end {eqnarray}
where the \textbf{Lorentz factor} is defined
\begin {eqnarray}
    \gamma:
    = 
    \frac{1}{\sqrt{1 - v^2/c^2}}
    =
    \frac{1}{\sqrt{1 - \beta^2}}.
\end {eqnarray}
Thus, we obtain the well-known formula for relativistic aberration
\begin {eqnarray}
    \label{eq:relativistic_aberration}
    \tan\theta' = \frac{y'}{x'} = \frac{\tan\theta}{\gamma(1 + \beta\sec\theta)}
\end {eqnarray}
and the more general expression
\begin {eqnarray}
    \theta' 
    =
    \textrm{atan2}\left[\sin\theta, \gamma(\cos\theta + \beta)\right]
\end {eqnarray}
The only difference between classical and relativistic aberration is the Lorentz 
factor. When $\beta$ is small, the difference between relativistic and classical 
results can be usually ignored. At velocities close to the speed of light, the 
Lorentz factor leads to light sources accumulating around direction of motion 
(see Figure \ref{fig:classicrel}).

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.6\columnwidth, viewport=100 70 370 220, clip=true] {fig/aberration3d.eps}
     \caption{\label{fig:3d} Three-dimensional depiction of the aberration 
     correction for a velocity vector and the associated rotational symmetry.}
  \end {center}
\end {figure} 



\subsection{General Vector Expression for Aberration}
For practical computations, it is often more convenient to use vectors. Any 
vector expression for aberration will involve addition of velocity vectors,
which is non-trivial in relativistic case.
\subsubsection{Classical Aberration}
In the classical case, the transformation of velocities is simply 
\begin {eqnarray}
    \label{eq:classicaladd}
    \vc u' = \vc u - \vc v.
\end {eqnarray}
The direction to target $\vu s = -\vc u'/|\vu u'|$ corrected for aberration is 
called the \textbf{proper direction}. Unlike the relativistic expression
$\vu s = -\vc u'/c$ , the 
classical expression for the proper direction needs to take into account that 
classical addition of velocities can lead to velocity of light greater than 
$c$. The \textbf{uncorrected direction} in both cases can be written 
$\vu p = -\vu u/c$. 

Direct substitution to $(\ref{eq:classicaladd})$, yields
\begin {eqnarray}
    -\vu s|c\vu p + \vc v|
    =
    -c\vu p - \vc v
\end {eqnarray}
and denoting $\vc\beta = \vc v/c$, we obtain the classical vector expression 
for proper direction
\begin {eqnarray}
    \label{eq:classical_properdir}
    \boxed{
        \quad
        \vu s
        =
        \frac{\vu p + \vc v/c}{|\vu p + \vc v/c|}
        =
        \frac{\vu p + \vc\beta}{|\vu p + \vc\beta|}
        \quad
    }.
\end {eqnarray}

\subsubsection{General Lorentz Transformation of Velocities}
Let $S'$ move w.r.t. $S$ with velocity $\vc v$ and denote 
\begin {eqnarray}
    \vc u := \diff{\vc r}{t}, 
    \quad
    \vc u' := \diff{\vc r'}{t'},.
\end {eqnarray}
Then, the Lorentz transformation will only affect coordinates along the direction 
of the velocity. That is, parallel and perpendicular components of $d\vc r$ 
transform as
\begin {eqnarray}
    d\vc r_{||}' &=& \gamma\left(d\vc r_{||} - \vc v\:dt\right)
    \\
    d\vc r_{\perp}' &=& d\vc r_\perp.
\end {eqnarray}
The time transforms as 
\begin {eqnarray}
    dt' &=&
    \gamma\left(
        dt - \frac{\vc v\cdot d\vc r}{c^2}
    \right)
    =
    \gamma\left(
        1 - \frac{\vc v\cdot \vc u}{c^2}
    \right)dt.
\end {eqnarray}
Now we can expand the components of velocity in $S'$
\begin {eqnarray}
    \vc u_{||}'
    &=&
    \diff{\vc r_{||}'}{t'}
    = \frac{\gamma(\vc r_{||} - \vc v\:dt)}{\gamma(1 - \vc v\cdot\vc u/c^2)dt}
    = \frac{\vc u_{||} - \vc v}{1 - \vc v\cdot\vc u/c^2}
    \\
    \vc u_{\perp}'
    &=&
    \diff{\vc r_{\perp}'}{t'}
    =
    \frac{d\vc r_\perp}{\gamma(1 - \vc v\cdot\vc u/c^2)dt}
    =
    \frac{\vc u_\perp}{\gamma(1 - \vc v\cdot\vc u/c^2)}
\end {eqnarray}
The velocity in $S'$ can be expanded using 
\begin {eqnarray}
    \vc u_{||}=\frac{\vc u\cdot\vc v}{v^2}\vc v,
    \quad 
    \vc u_\perp = \vc u - \vc u_{||} = \vc u - \frac{\vc u\cdot\vc v}{v^2}\vc v
\end {eqnarray}
leading to 
\begin {eqnarray}
    \vc u' &=& \vc u_{||}' + \vc u_\perp'
    \\
    &=& 
    \frac{\vc u_{||} - \vc v + \vc u_\perp/\gamma}{1 - \vc v\cdot\vc u/c^2}
    \\
    &=& 
    \frac{1}{1 - \vc v\cdot\vc u/c^2}
    \left[
        \frac{\vc u\cdot\vc v}{v^2}\vc v 
        - \vc v
        + \frac{1}{\gamma}\left(
            \vc u - \frac{\vc u\cdot\vc v}{v^2}\vc v
        \right)
    \right]
    \\
    &=& 
    \frac{1}{1 - \vc v\cdot\vc u/c^2}
    \left\{
        \frac{1}{\gamma}\vc u
        +
        \vc v 
        \left[
             \frac{\vc u\cdot\vc v}{v^2}\left(1 - \frac{1}{\gamma}\right) - 1
        \right]
    \right\}
    \\
    \label{eq:vector_lorentz_vel}
    &=& 
    \frac{1}{\gamma(1 - \vc v\cdot\vc u/c^2)}
    \left[
        \vc u
        +
        \vc v 
        \left(
             \frac{\vc u\cdot\vc v}{v^2}\left(\gamma - 1\right) - \gamma
        \right)
    \right].
\end {eqnarray}


\subsubsection{Relativistic Aberration}
Let $\vu n= \vc u/c$ be the direction of light propagation and 
$\vu s = -\vc u'/c$ be the (relativistic) proper direction. Substitution to the
General Lorentz Transformation for velocities $(\ref{eq:vector_lorentz_vel})$ then 
yields 
\begin {eqnarray}
    -c\vu s 
    &=&
    \frac{1}{\gamma(1 - \vu n\cdot\vc v/c)}
    \left\{
        c\vu n
        +
        \vc v 
        \left[
             \frac{c}{v^2}(\vu n\cdot\vc v)\left(\gamma - 1\right) - \gamma
        \right]
    \right\}
\end {eqnarray}
or
\begin {eqnarray}
    \vu s 
    &=&
    \frac{1}{\gamma(1 - \vu n\cdot\vc v/c)}
    \left\{
        -\vu n
        +
        \vc v 
        \left[
             \frac{\gamma}{c} - \frac{1}{v^2}(\vu n\cdot\vc v)\left(\gamma - 1\right)
        \right]
    \right\}
    \\
    &=&
    \frac{1}{\gamma(1 - \vu n\cdot\vc v/c)}
    \left\{
        -\vu n
        +
        \vc v 
        \frac{\gamma}{c}
        \left[
             1 - \frac{c}{v^2}(\vu n\cdot\vc v)\frac{\gamma - 1}{\gamma}
        \right]
    \right\}
    \\
    &=&
    \frac{1}{\gamma(1 - \vu n\cdot\vc v/c)}
    \left[
        -\vu n
        +
        \vc v 
        \frac{\gamma}{c}
        \left(
             1 - \frac{\gamma}{\gamma + 1}\frac{\vc v\cdot\vu n}{c}
        \right)
    \right], 
\end {eqnarray}
where in the last step we have used 
\begin{eqnarray}
    \frac{\gamma - 1}{\gamma\beta^2} 
    &=&
    \frac{\gamma - 1}{\gamma(1 - \gamma^{-2})}
    =
    \frac{\gamma^2 - \gamma}{\gamma^2 - 1}
    =
    \gamma\frac{\gamma - 1}{(\gamma - 1)(\gamma + 1)}
    = \frac{\gamma}{\gamma + 1}
    \\
    \Rightarrow
    \frac{c}{v^2}\frac{\gamma - 1}{\gamma}(\vc v\cdot\vu n)
    &=& \frac{1}{c}\frac{\gamma - 1}{\gamma\beta^2}(\vc v\cdot\vu n)
\end {eqnarray}
Denoting $\vc\beta=\vc v/c$, we obtain expression for the proper direction
\begin {eqnarray}
    \label{eq:properdir1}
    \vu s 
    =
    \frac{1}{\gamma(1 - \vu n\cdot\vc\beta)}
    \left[
        -\vu n 
        + 
        \gamma\vc\beta 
        \left(
            1 - \frac{\gamma}{\gamma + 1}\vc\beta\cdot\vu n
        \right)
    \right]
\end {eqnarray}
Let $\vc p = -\vu n$ be the uncorrected direction. Then $(\ref{eq:properdir1})$ can 
be expressed 
\begin {eqnarray}
    \boxed{
        \quad
        \label{eq:properdir2}
        \vu s 
        =
        \frac{1}{\gamma(1 + \vu p\cdot\vc\beta)}
        \left[
            \vu p 
            + 
            \gamma\vc\beta 
            \left(
                1 + \frac{\gamma}{\gamma + 1}\vc\beta\cdot\vu p
            \right)
        \right].    
        \quad
    }
\end {eqnarray}

\subsection{Series Expansion of Aberration Correction}
\subsubsection{Classical Aberration}
Cross product of $(\ref{eq:classical_properdir})$ with uncorrected 
direction $\vc p$, yields
\begin {eqnarray}
    \sin\Delta\theta\:\vu n
    =
    \vu p\times\vu s 
    = 
    \frac{\vu p\times\vu p + \vu p\times\vc\beta}{|\vu p + \vc\beta|}
    = 
    \frac{\vu p\times\vc\beta}{|\vu p + \vc\beta|}
    = 
    \frac{||\vu p||\:||\vc\beta||\sin\theta\:\vu n}{|\vu p + \vc\beta|}
    = 
    \frac{\beta\sin\theta\:\vu n}{\sqrt{1 + 2\beta\cos\theta + \beta^2}},
\end {eqnarray}
where we have used 
\begin {eqnarray}
    ||\vu p + \vc\beta||^2
    &=&
    (||\vu p|| + ||\vc\beta||\cos\theta)^2 + \beta^2\sin^2\theta
    \\
    &=&
    1 + 2\beta\cos\theta + \beta^2\cos^2\theta + \beta^2\sin^2\theta 
    \\
    &=&
    1 + 2\beta\cos\theta + \beta^2.
\end {eqnarray}
According to generalized binomial theorem
\begin {eqnarray}
    \frac{1}{\sqrt{1 + x}} 
    = 
    \sum_{k=0}^\infty
    \binom{-1/2}{k}x^n 
    \approx 
    1 - \frac{1}{2}x + \frac{3}{8}x^2 - \frac{5}{16}x^3 + ...
\end {eqnarray}
Substitution of $x=2\beta\cos\theta + \beta^2$, yields
\begin {eqnarray}
    \frac{1}{\sqrt{1 + 2\beta\cos\theta + \beta^2}}
    &\approx&
    1 
    -
    \frac{1}{2}(2\beta\cos\theta + \beta^2)
    +
    \frac{3}{8}(2\beta\cos\theta + \beta^2)^2
    \\
    &=&
    1 - \cos\theta\beta 
    + 
    \left(\frac{3}{2}\cos^2\theta - \frac{1}{2}\right)\beta^2
    +
    \frac{3}{2}\cos\theta\beta^3 
    +
    \frac{3}{8}\beta^4
\end {eqnarray}
and if we ignore everything above fourth power of $\beta$, we can expand 
\begin {eqnarray}
    \sin\Delta\theta 
    \approx
    \beta\sin\theta 
    -
    \frac{1}{2}\beta^2\sin 2\theta
    +
    \frac{1}{8}\beta^3(3\sin 3\theta - \sin\theta)
    + 
    \frac{3}{4}\beta^4\sin 2\theta
\end {eqnarray}
Note that when such a series is expressed as a linear combination 
of sinusoidal terms, it is obvious that $\Delta\theta$ antisymmetric w.r.t. 
$\theta$ and zero at $\theta=0$. The above formula also produces a positive
$\Delta\theta$ with positive $\theta$, which is incorrect.
In most applications, where $\beta$ is small, we can approximate 
\begin {eqnarray}
    \label{eq:classical_series}
    \boxed{
        \quad
        \Delta\theta \approx\sin\Delta\theta \approx 
        -\beta\sin\theta + \frac{1}{2}\beta^2\sin 2\theta.
        \quad
    }
\end {eqnarray}

\subsubsection{Relativistic Aberration}
Cross product of $(\ref{eq:properdir2})$ with uncorrected direction $\vu p$, 
yields
\begin {eqnarray}
    ||\vu s||\:||\vu p||\sin\Delta\theta \vu n
    &=&
    \vu s\times\vu p 
    \\
    &=&
    \frac{\vc \beta\times\vu p}{1 + \vu p\cdot\vc\beta}
    \left(
        1 + \frac{\gamma}{\gamma + 1} \vc\beta\cdot\vu p
    \right)
    \\
    &=&
    \frac{\beta\sin\theta}{1 + \beta\cos\theta}
    \left(
        1 + \frac{\gamma}{\gamma + 1}\beta\cos\theta
    \right)
    \vu n.
\end {eqnarray}
To obtain a series expansion for $\sin\Delta\theta$, note that:
\begin {eqnarray}
    \frac{1}{1 + \beta\cos\theta}
    &=& 
    \sum_{k=0}^\infty(-1)^k \beta^k \cos^k\theta
    \approx 
    1 - \beta\cos\theta + \beta^2\cos^2\theta,
    \\
    \frac{\gamma}{\gamma + 1}
    &=&
    \frac{1}{1 + \sqrt{1 - \beta^2}}
    =
    \frac{1}{1 + \sqrt{1 - \beta^2}}
    \frac{1 - \sqrt{1 - \beta^2}}{1 - \sqrt{1 - \beta^2}}
    =
    \frac{1 - \sqrt{1 - \beta^2}}{\beta^2},
    \\
    \sqrt{1 - \beta^2} 
    &=&
    \sum_{k=0}^{\infty}
    \binom{1/2}{k}(-1)^k \beta^{2k}
    \approx 
    1 - \frac{1}{2}\beta^2 + \frac{1}{8}\beta^4.
\end {eqnarray}
Thus, we can also expand 
\begin {eqnarray}
  \frac{1 - \sqrt{1 - \beta^2}}{\beta^2}
    &\approx&
    \frac{1}{\beta^2}
    \left[
        1 - \left(1 - \frac{1}{2}\beta^2 + \frac{1}{8}\beta^4\right)
    \right]
    =
    \frac{1}{2} - \frac{1}{8}\beta^2,
    \\
    \beta\sin\theta\left(
        1 + \frac{\gamma}{\gamma + 1}\beta\cos\theta
    \right)
    &\approx&
    \beta\sin\theta + \beta^2\sin\theta\cos\theta 
    \left(
         \frac{1}{2} - \frac{1}{8}\beta^2
    \right)
    \approx
    \beta\sin\theta + \frac{1}{4}\beta^2\sin 2\theta\quad
\end {eqnarray}
and finally 
\begin {eqnarray}
    \sin\Delta\theta 
    &\approx&
    \left(1 - \beta\cos\theta\right)
    \left(\beta\sin\theta + \frac{1}{4}\beta^2\sin 2\theta\right)    
    \\
    &\approx&
    \beta\sin\theta - \beta^2\sin\theta\cos\theta + \frac{1}{4}\beta^2\sin 2\theta
\end {eqnarray}
Thus, again noting the sign, we obtain the approximation
\begin{eqnarray}
    \label{eq:relativistic_series}
    \boxed{
        \quad
        \Delta\theta
        \approx
        \sin\Delta\theta
        \approx
        -\beta\sin\theta + \frac{1}{4}\beta^2\sin 2\theta.
        \quad        
    }
\end {eqnarray}
\subsubsection{Accuracy}
The difference in the quadratic term between $(\ref{eq:relativistic_series})$ 
and $(\ref{eq:classical_series})$ suggests that the linear approximation can be
more preferrable than the quadratic classical approximation. 
Comparison with two values of $\theta$ is shown in Figure \ref{fig:series}.
Worst case (w.r.t. $\theta$) relative errors are shown in Figure \ref{fig:error}.

The linear approximation is usually sufficient for most purposes in astrometry:
For example, if Earth's speed along it's orbit is about $30$ km/s or 
$\beta\approx 10^{-4}$, the maximum relative error from linear and quadratic 
approximations are on the scale of $10^{-4}$ and $10^{-8}$, respectively. If the 
maximum aberration is around $20$", this corresponds to absolute errors 
around $2$ mas and $0.2$ $\mu$as, respectively.

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=1\columnwidth] {fig/aberration_series.eps}
     \caption{\label{fig:series} Linear and quadratic approximation of classical and relativistic aberration.}
  \end {center}
\end {figure} 
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=1\columnwidth] {fig/aberration_error.eps}
     \caption{\label{fig:error} Maximum aberration error with respect to the exact 
     relativistic formula.}
  \end {center}
\end {figure} 

\subsection{Spherical Coordinates}
We expand uncorrected direction 
\begin {eqnarray}
    \vu p
    = 
    \begin {bmatrix}
        \cos\delta\cos\alpha \\
        \cos\delta\sin\alpha \\
        \sin\delta
    \end {bmatrix},
\end {eqnarray}
where $\delta$ and $\alpha$ are the declination and the right ascension, 
respectively (in appropriate frames). Then, unit vectors along the 
declination and right ascension coordinates can be written 
\begin {eqnarray}
    \vu e_{\delta} =\pdiff{\vu p}{\delta}
    = 
    \begin {bmatrix}
        -\sin\delta\cos\alpha \\
        -\sin\delta\sin\alpha \\
        \cos\delta
    \end {bmatrix},
    \quad
    \vu e_{\alpha} 
    =
    \frac{1}{\cos\delta}\pdiff{\vu p}{\alpha}
    = 
    \begin {bmatrix}
        -\sin\alpha \\
        \cos\alpha \\
        0
    \end {bmatrix}.
\end {eqnarray}
Thus, for small $\vu s - \vu p$, we can approximate 
\begin {eqnarray}
    \Delta\delta &=& (\vu s - \vu p)\cdot\vu e_\delta
    \\
    \cos\delta \Delta\alpha &=& (\vu s - \vu p)\cdot\vu e_\alpha
\end {eqnarray}
For small $v/c$, we can approximate from $(\ref{eq:classical_properdir})$ 
\begin {eqnarray}
    \vu s - \vu p \approx \vc\beta.
\end {eqnarray}
Thereafter, we obtain 
\begin {eqnarray}
    \label{eq:spherical_decl}
    \Delta\delta 
    &=& 
    \vu e_\delta \cdot\vc\beta
    =
    -\beta_x\sin\delta\cos\alpha - \beta_y\sin\delta\sin\alpha + \beta_z\cos\delta
    \\
    \label{eq:spherical_ra}
    \cos\delta\Delta\alpha 
    &=& 
    \vu e_\alpha\cdot\vc\beta 
    = 
    - \beta_x\sin\alpha + \beta_y\cos\alpha.
\end {eqnarray}
\newpage
\section{Stellar Aberration}
\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \draw[thick] (0, -1) -- (3, -0.5);
        \draw[thick] (0, -1) -- (3, -1.5);
        \draw[thick] (0, -1) -- (2.75, -0.25);
        \draw[thick] (0, -1) -- (2.75, -1.75);
        \draw[thick] (3, -1) ellipse (0.25 and 0.5);
        \draw[thick] (3, -0.425) arc(50:310:0.375 and 0.75);        
        \draw[densely dotted] (0, -1) -- (3, -1);
        \draw[thick, ->] (3, -1) -- (3.5, -1);

        \draw[thick, ->] (0, -1) -- (6, 0.0);
        \draw[thick, ->] (0, -1) -- (5.85, 0.6);
        %\draw (6, 0.0) node{$\bullet$};
        %\draw (5.85, 0.6) node{$\bullet$};
        %\draw (4.75, 0.55) node[rotate=15] {Uncorrected};
        %\draw (4.75, -0.41) node[rotate=9]{Corrected};
        
        \draw[thick, <-] (5, -0.18) arc(-10:60:0.25 and 0.5);
        \draw[thick] (5.5, 0.2) node{$\Delta\theta$};

        \draw (0, -1) node{$\bullet$};
        %\draw (3, -1) node{$\bullet$};
        \draw (4, -1) node{$\vc v$};
        \draw (0, 1) node{$\bullet$};

        \draw[thick] (0, 1) -- (3, 1.75);
        \draw[thick] (0, 1) -- (3, 0.25);
        \draw[thick] (3, 1) ellipse (0.375 and 0.75);
        \draw[thick, ->] (0, 1) -- (6, 2.5);
        \draw[thick, ->] (0, 1) -- (5.85, 3.125);
        %\draw(5.0, 2.0) node[rotate=14] {Uncorrected};
        %\draw (4.5, 2.9) node[rotate=19] {Corrected};
        \draw[thick] (3.125, 1.75) arc(50:310:0.5 and 1);        
        \draw[thick, ->] (0, 1) -- (-2, 1);
        \draw[thick, ->] (5, 2.25) arc(-10:60:0.25 and 0.5);
        \draw[thick] (5.4, 2.65) node{$\Delta\theta$};
        \draw (-2.25, 1) node{$\vc v$};



        %\draw[thick] (0, 1) -- (-3, 0.5);
        %\draw[thick] (0, 1) -- (-3, 1.5);
        %\draw[thick] (0, 1) -- (-2.75, 0.25);
        %\draw[thick] (0, 1) -- (-2.75, 1.75);
        %\draw[thick] (-3, 1) ellipse (0.25 and 0.5);
        %\draw[thick] (-3, 0.425) arc(230:480:0.375 and 0.75);        
        %\draw[densely dotted] (0, 1) -- (-3, 1);
        %\draw[thick, ->] (-3, 1) -- (-3.5, 1);
        %\draw (0, 1) node{$\bullet$};
        %\draw (-3, 1) node{$\bullet$};
        %\draw (-4, 1) node{$\vc v$};

        \draw (0, 0) node{$\bullet$};
        \draw (0, 1.35) node{$\oplus$};
        \draw (0, -0.65) node{$\oplus$};
        \draw (0, 0.35) node{$\sun$};

        \draw[thick] (0,0) ellipse (2 and 1);

        \draw[thick] (9, 0) ellipse (1.5 and 1.5);
        \draw[thick, <-] (10.25, 0) arc(0:180:1.25 and 1.25);
        \draw[densely dotted] (9, 1.5) -- (10.6, 1.5);
        \draw[thick, ->] (10.6, 1.5) -- (11.5, 1.5);
        \draw (9, 1.5) node{$\bullet$};
        \draw (11.75, 1.5) node{$\vc v$};
        \draw[thick, ->] (9, 1.5) -- (12.25, 3.25);
        \draw[thick, ->] (9, 1.5) -- (12.5, 2.5);
        \draw[thick, -] (9, 1.5) -- (10.5, 0.75);
        \draw[thick, -] (9, 1.5) -- (10.6, 1.05);
        \draw[thick, <-] (11.5, 2.25) arc(0:60:0.30 and 0.6);
        \draw (11.8, 2.65) node{$\Delta\theta$};
        %\draw (11.5, 3.2) node[rotate=29] {Uncorrected};
        %\draw (11.5, 2) node[rotate=15] {Corrected};
        \draw[thick] (10.5, 1.5) ellipse (0.375 and 0.75);
        \draw[thick] (10.6, 1.5) ellipse (0.225 and 0.45);

    \end {tikzpicture}
    \caption{\label{fig:aberration_types}Annual aberration correction for a planet 
        orbiting the Sun (left). Diurnal aberration correction for an observer on the 
        surface of a rotating planet (right). The cones depict rotational symmetry in the correction.}
  \end {center}
\end {figure}

\textbf{Stellar aberration} refers to the apparent change in the position 
of a stellar object due to velocity of the observer. For an observer fixed 
to the surface of a rotating planet, the stellar aberration may involve:
\begin {itemize}
    \item \textbf{Annual aberration} resulting from the motion of the planet 
    around the barycenter of the solar system. For Earth, the velocity of 
    $29.79\:$km/s around the barycenter of the solar system amounts to a 
    maximum correction on $20.496$ arcseconds.
    \item \textbf{Diurnal aberration} resulting from the rotation of the 
    planet. At the equator, Earth rotates approximately with the tangential
    velocity of $465$ meters per second, which amounts to a maximum 
    correction of $0.32$ arcseconds.
    \item \textbf{Secular aberration} resulting from the approximately uniform 
    motion of the solar system around the center of the galaxy. For our 
    solar system, this velocity. is about $220$ km/s and amounts to a 
    maximum correction of 150". However, since the velocity changes very slowly, 
    the effect is included in the catalogued positions and is not corrected.
    \item \textbf{Planetary aberration} resulting from both the motion 
    of the observer and the movement of the observed body. 
\end {itemize}
Aberration can also result from the observer moving w.r.t. 
the surface of the planet. For example, a fighter jet or a missile 
can travel at speeds higher than the rotation speed of Earth. However, 
this effect is likely always small enough to be neglected in technical 
applications.
For a satellite on LEO moving at $8$ km/s w.r.t. inertial frame centered 
on Earth, the maximum aberration is around $5.5$ arcseconds. 

The expressions developed in the previous section apply to all types of 
aberration. 

\subsection{Linear Approximation in Spherical Coordinates}
\subsubsection{Annual Aberration}
For elliptic orbits, the velocity and distance from the center can be 
expressed 
\begin {eqnarray}
    v 
    =
    \sqrt{
        \mu\left(\frac{2}{r} - \frac{1}{a}\right)
    },
    \quad
    r 
    = \frac{a(1-e^2)}{1 + e\cos f}.
\end {eqnarray}
At perihelion and aphelion $f=0$ and $f=180^\circ$, respectively corresponding
to maximum and minimum velocities
\begin {eqnarray}
    v_{max} = \sqrt{
        \frac{\mu}{a}
        \left(
            \frac{1+e}{1-e}
        \right)
    },
    \quad
    v_{min} = \sqrt{
        \frac{\mu}{a}
        \left(
            \frac{1-e}{1+e}
        \right)
    }.
\end {eqnarray}
For Earth's orbit around the Sun, we can substitue 
$\mu = 1.32712440042\cdot 10^{20}\:\textrm{m}^3\textrm{s}^{-2}$, 
$e = 0.01671022$ and $a=1.495980229607128\cdot 10^{11}$ m leading to
\begin {eqnarray}
    v_{max} = 30286.614\:\textrm{m/s},
    \quad
    v_{min} = 29291.058\:\textrm{m/s},
    \quad 
    v_{avg} = 29790.915\:\textrm{m/s}.
\end {eqnarray}
The \textbf{constant of aberration} $\kappa$ is the maximum possible displacement 
of a distant object due to aberration and can be approximated $\kappa\approx v/c$.
Correspondingly, we obtain 
\begin {eqnarray}
    \kappa_{max} = \SI{20.838}{\arcsecond}, 
    \quad
    \kappa_{min} = \SI{20.153}{\arcsecond} , 
    \quad
    \kappa_{avg} = \SI{20.497}{\arcsecond}. 
\end {eqnarray}
To obtain geometric intuition about annual aberration throughout the year, 
consider a circular orbit with zero inclination. That is, 
\begin {eqnarray}
    \vc\beta (t) &=& \beta(\cos\omega t, \sin\omega t, 0).
\end {eqnarray}
Substitution to $(\ref{eq:spherical_decl})$ and $(\ref{eq:spherical_ra})$,
yields 
\begin {eqnarray}
    \Delta\delta &=& 
    -\beta \sin\delta\cos\alpha \cos\omega t
    -\beta \sin\delta\sin\alpha \sin\omega t
    \\
    \cos\delta\Delta\alpha &=& 
    -\beta \sin\alpha \cos\omega t
    +\beta \cos\alpha \sin\omega t.
\end {eqnarray}
Suppose $\alpha=0$. Then, the above simplifies to 
\begin {eqnarray}
    \Delta\delta &=& 
    -\beta \sin\delta\cos\omega t,
    \\
    \cos\delta\Delta\alpha &=& 
    \beta\sin\omega t.
\end {eqnarray}
That is, annual aberration will lead to a displacement shaped like an ellipse
with a period of one orbit (see Figure \ref{fig:aberration_ellipse}).

\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \draw[thick] (-2, 0) -- (-2, 1.5);
        \draw[thick] (0, 0) -- (0, 1.5);
        \draw[thick] (0, 0) -- (2.5, 0);
        \draw[thick] (0, -1) -- (2.5, -1);
        \draw[thick, <->] (-2, 1.25) -- (0, 1.25);
        \draw[thick, <->] (2.25, -1) -- (2.25, 0);
        \draw[thick, ->] (0, 0) -- (2.75, 0);
        \draw[thick, ->] (0, 0) -- (0, 1.75);
        \draw (0, -1) node{$\bullet$};
        \draw (0, 0) node{$\bullet$};
        \draw (-2, 0) node{$\bullet$};
        %\draw (0, -1.3) node{$\earth$};
        %\draw (0, -0.3) node{$\sun$};

        \draw[thick] (0,0) ellipse (2 and 1);
        \draw (-1, 1.55) node{$\beta$};
        \draw (2.5, -0.5) node{$\:\:\quad\quad \beta\sin\delta$};
        \draw (-0.5, -0.25) node{$(\alpha, \delta)$};

        \draw (2.75, 0.35) node{$\:\:\Delta\alpha\cos\delta$};
        \draw (0.25, 1.5) node{$\:\:\Delta\delta$};
    \end {tikzpicture}
    \caption{\label{fig:aberration_ellipse}Elliptical shape of abberation correction w.r.t.
            the uncorrected position.}
  \end {center}
\end {figure}
\subsubsection{Diurnal Aberration}
The velocity of the observer on the surface of Earth can be written
\begin {eqnarray}
    v = \omega(R + h)\cos\phi,
\end {eqnarray}
where $R, h$ and $\phi$ are the radius of Earth, altitude of the observer 
above the surface of Earth and the latitude. Consequently, the aberration 
can be approximated
\begin {eqnarray}
    \Delta\theta \approx \beta \approx \frac{\omega(R + h)}{c}\cos\phi.
\end {eqnarray}
Substitution of $R= 6371\:$km, $\omega = 2\pi/86164.0905$ s yields at the 
equator
\begin {eqnarray}
    \Delta\theta \approx -\SI{0.3196}{\arcsecond}.
\end {eqnarray}
The velocity is always approximately towards the east corresponding to the 
x-axis in the ENU frame. That is, substituting $\vc\beta=\beta\vu x$ to 
$(\ref{eq:spherical_decl})$ and $(\ref{eq:spherical_ra})$, yields 
\begin {eqnarray}
    \Delta\delta &=& - \beta\sin\delta\cos\alpha 
    \\
    \cos\delta\Delta\alpha &=& - \beta\sin\alpha.
\end {eqnarray}
The notation above is misleading in the sense $\delta$ and $\alpha$ do not 
refer to declination and right ascension. To obtain an expression in terms 
of elevation and azimuth, substitute for $a = \delta$ and 
$\alpha = 90^\circ - \phi$ to obtain 
\begin {eqnarray}
    \Delta a &=& -\beta\sin a\sin\phi, \\
    \cos a\Delta\phi &=& \beta\cos\phi.
\end {eqnarray}
For $\phi = 90^\circ$ (east), we obtain $\Delta a = -\beta\sin a$ and for 
$a = 0$, we obtain $\Delta\phi = \beta\cos\phi = -\beta\sin (\phi - 90^\circ)$, 
which is consistent with $(\ref{eq:relativistic_series})$.

\subsection{Planetary Aberration and Light-Time}
The travel time of light between target and the observer is called 
\textbf{light-time} and denoted $\tau$. When the direction to target 
changes significantly during light-time, this requires a correction. 
The relative apparent position to target can be expressed 
\begin {eqnarray}
    \vc p(t) = \vc u_B(t - \tau) - \vc E_B(t),
\end {eqnarray}
where $\vc u_B$ and $\vc E_B$ are the barycentric positions of the 
target and the observer. Application of $(\ref{eq:classical_properdir})$ 
yields 
\begin {eqnarray}
    \vc s(t) &=& \vc p(t) + \beta|\vc p|
    \\
    &=& 
    \vc u_B(t - \tau) - \vc E_B(t) + \frac{|\vc p|}{c}\dot{\vc E_B}(t)
    \\
    &=& 
    \vc u_B(t - \tau) - \vc E_B(t) + \tau\dot{\vc E_B}(t)
    \\
    &\approx& 
    \vc u_B(t - \tau) - \vc E_B(t - \tau).
\end {eqnarray}
That is, correcting for planetary aberration at $t$ with classical approximation 
$(\ref{eq:classical_properdir})$ is equivalent to the computation the uncorrected 
direction to target at $t-\tau$. Note that this does not take into account 
the diurnal aberration.

\subsection{Practical Computation}
The positions of stars are typically catalogued w.r.t. the Solar System 
Barycenter (SSB) so that secular aberration is already included in the 
catalogued positions. Thus, to compute the aberration correction for an 
observer, we need to compute the velcoity vector of the observer w.r.t. 
the SSB. For an observer on Earth, this velocity is the sum of the 
orbital velocity of the Earth around the SSB and the rotational velocity 
of the topocentric position of the observer around the geocenter (GEO) of 
Earth. Thereafter, $(\ref{eq:classical_properdir})$ and 
$(\ref{eq:properdir2})$ can be applied in any topocentric frame centered 
on the observer position.

\subsubsection{Transformations Between Frames}
Let us denote the position and velocity coordinate vector for target 
$C$ in frame with orientation $A$ and origin $B$ with $\vc r_{C(A)}^B$
and $\vc v_{C(A)}^B$. Omission of $C$, $A$ or $B$ in an expression 
signifies that the expression applies for all targets, orientations or 
origins, respectively. Then, if $R_A^a$ is the rotation matrix from
orientation a to A, we can write 
\begin {eqnarray}
    \label{eq:posrotation}
    \vc r_{(A)} = R_A^a\vc r_{(a)}
    \quad\Leftrightarrow\quad
    \vc r_{C(A)}^B = R_A^a\vc r_{C(a)}^B
    \quad 
    \forall B, C.
\end {eqnarray}
Similarly, for any two origins B and b 
\begin {eqnarray}
    \vc r^B = \vc r^b - \vc r^b_B 
    \quad\Leftrightarrow\quad
    \vc r_{C(A)}^B = \vc r_{C(A)}^b - \vc r_{B(A)}^b 
    \quad 
    \forall A, C.
\end {eqnarray}
The equation $(\ref{eq:posrotation})$ does not apply to velocity vectors
unless the rotation matrix is constant w.r.t. time. More generally, we can 
expand  
\begin {eqnarray}
    \vc v_{(A)}
    =
    \diff{}{t}\vc r_{(A)}
    = 
    \diff{}{t}\left(
        R_A^a\vc r_{(a)}
    \right)
    =
    \dot{R_A^a}\vc r_{(a)}
    +
    R_A^a
    \vc v_{(a)},
\end {eqnarray}
where the $\dot R_A^a\vc r_{(a)}$ corresponds to velocity component from 
the rotation of $\vc r_{(a)}$ w.r.t. the origin.

\subsubsection{Expansion of the Observer Velocity}
The position and velocity vectors w.r.t. origins at the GEO and the SSB
can be related by
\begin {eqnarray}
    \vc r^{GEO} &=& \vc r^{SSB} - \vc r_{GEO}^{SSB}, \\
    \vc v^{GEO} &=& \vc v^{SSB} - \vc v_{GEO}^{SSB},
\end {eqnarray}
where $\vc v_{GEO}^{SSB}$ is the orbital velocity of the geocenter w.r.t. 
the SSB. The rotation of the Earth can be expressed via the coordinate 
transform between inertial True-of-Date (ToD) and Pseudo-Earth-Fixed (PEF) 
frames 
\begin {eqnarray}
    \vc r_{(PEF)}^{GEO} 
    &=&
    R_{PEF}^{TOD} \vc r_{(TOD)}^{GEO}
    \quad : \quad 
    R_{PEF}^{TOD}
    =
    \begin {bmatrix}
        \cos GAST & \sin GAST & 0 \\
        -\sin GAST & \cos GAST & 0 \\
        0 & 0 & 1
    \end {bmatrix},
    \\
    \vc r_{(TOD)}^{GEO} 
    &=&
    R_{TOD}^{PEF} \vc r_{(PEF)}^{GEO}
    \quad : \quad 
    R_{TOD}^{PEF}
    =
    \begin {bmatrix}
        \cos GAST & -\sin GAST & 0 \\
        \sin GAST & \cos GAST & 0 \\
        0 & 0 & 1
    \end {bmatrix}.
\end {eqnarray}
where GAST is the Greenwich Apparent Sidereal Time. The corresponding velocities
can be expanded 
\begin {eqnarray}
    \vc v_{(PEF)}^{GEO}
    &=&
    R_{PEF}^{TOD}\vc v_{(TOD)}^{GEO}
    +
    {{\dot R}_{PEF}^{TOD}}\vc r_{(TOD)}^{GEO},
    \\
    \vc v_{(TOD)}^{GEO}
    &=&
    R_{TOD}^{PEF}\vc v_{(PEF)}^{GEO}
    +
    {{\dot R}_{TOD}^{PEF}}\vc r_{(PEF)}^{GEO},
\end {eqnarray}
where 
\begin {eqnarray}
    {{\dot R}_{PEF}^{TOD}} 
    &=&
    \diff{GAST}{t} 
    \begin {bmatrix}
        -\sin GAST & \cos GAST & 0 \\
        -\cos GAST & -\sin GAST & 0 \\
        0 & 0 & 0
    \end {bmatrix}
    \\
    {{\dot R}_{TOD}^{PEF}} 
    &=&
    \diff{GAST}{t} 
    \begin {bmatrix}
        -\sin GAST & -\cos GAST & 0 \\
        \cos GAST & -\sin GAST & 0 \\
        0 & 0 & 0
    \end {bmatrix}.
\end {eqnarray}
For computation of diurnal aberration amounting to less than $0.32$ arcseconds, 
we can approximate the time derivative of GAST using the length of a sidereal 
day
\begin {eqnarray}
    \diff{GAST}{t}
    \approx 
    \frac{2\pi\:\textrm{rad}}{86164.0905\:s}
    \approx 7.2921159\cdot 10^{-5} \textrm{rad/s}
    \approx 15.04107^\circ /h.
\end {eqnarray}
The velocity of the observer w.r.t. the SSB can be expressed 
\begin {eqnarray}
    \vc v_{(ECL)}^{SSB} 
    &=& 
    \vc v_{GEO,(ECL)}^{SSB} + R_{ECL}^{TOD}\vc v_{(TOD)}^{GEO} 
    \\
    &=& 
    \vc v_{GEO,(ECL)}^{SSB} + R_{ECL}^{TOD}
    \left(
    R_{TOD}^{PEF}\vc v_{(PEF)}^{GEO}
    +
    {{\dot R}_{TOD}^{PEF}}\vc r_{(PEF)}^{GEO}
    \right).
\end {eqnarray}
The position of the observer 
$\vc r_{(PEF)}^{GEO} = R_{PEF}^{EFI}\vc r_{(EFI)}^{GEO}$, where 
$\vc r_{(EFI)}^{GEO}$ can obtained from geodetic position on WGS84.
For an observer that is stationary w.r.t. surface of Earth 
$\vc v_{(PEF)}^{GEO} = \vc 0$.

Aberration corrections $(\ref{eq:classical_properdir})$ and 
$(\ref{eq:properdir2})$ can be applied in the ecliptic frame centered 
on the SSB or the topocentric ENU frame of the observer. Application in an 
ENU frame requires rotation 
\begin {eqnarray}
    R^{ECL}_{ENU}\vc v_{(ECL)}^{SSB} 
    &=& 
    R^{ECL}_{ENU}\vc v_{GEO,(ECL)}^{SSB} + R_{ENU}^{TOD}
    \left(
    R_{TOD}^{PEF}\vc v_{(PEF)}^{GEO}
    +
    {{\dot R}_{TOD}^{PEF}}\vc r_{(PEF)}^{GEO}
    \right).
\end {eqnarray}
Note that since the aberration relates to the velocity difference between 
the observer and the SSB in an inertial frame, it is not appropriate to 
transfer the velocity of SSB to a topocentric frame, where it would rotate 
around the observer location at very high speed.


\newpage
\section{Doppler Effect}
\subsection{Classical and Relativistic Doppler Effect}
\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \clip (-0.5, -1.5) rectangle (9, 1.5);
\draw[color=gray!50] (7-5.5, 0.5) circle (3.5);
\draw[color=gray!50] (7-5.375, 0.5) circle (3.25);
\draw[color=gray!50] (7-5.25, 0.5) circle (3.0);
\draw[color=gray!50] (7-5.125, 0.5) circle (2.75);
\draw[color=gray!50] (7-5.0, 0.5) circle (2.5);
\draw[color=gray!50] (7-4.875, 0.5) circle (2.25);
\draw[color=gray!50] (7-4.75, 0.5) circle (2.0);
\draw[color=gray!50] (7-4.625, 0.5) circle (1.75);
\draw[color=gray!50] (7-4.5, 0.5) circle (1.5);
\draw[color=gray!50] (7-4.375, 0.5) circle (1.25);
\draw[color=gray!50] (7-4.25, 0.5) circle (1.0);
\draw[color=gray!50] (7-4.125, 0.5) circle (0.75);
\draw[color=gray!50] (7-4.0, 0.5) circle (0.5);
\draw[color=gray!50] (7-3.875, 0.5) circle (0.25);

        \draw[thick] (0, 0) -- (3, 0);
        \draw[thick] (0, 1) -- (3, 1);
        \draw[thick] (0, 0) -- (0, 1);
        \draw[thick] (3, 0) -- (3, 1);
        \draw[thick, ->] (3, 0.5) -- (6, 0.5);
        \draw[thick] (3, 0.5) -- (5, -0.5);
        \draw[thick] (1.5, 0.5) node{Emitter ($S'$)};
        \draw[thick] (4.5, 0.8) node{$v$};
        \draw[thick] (3.7, 0.14) arc(-45:0:0.5 and 0.5);
        \draw[thick] (4.1, 0.3) node{$\theta$};
        \draw[thick] (5.5, -0.7) ellipse (0.5 and 0.5);
        \fill[black] (5.25, -0.55) ellipse (0.10 and 0.15);
        \draw[thick] (5.25, -0.55) ellipse (0.175 and 0.25);
        \draw[thick] (7.5, -0.5) node{Observer ($S$)};
   \end {tikzpicture}
    \caption{\label{fig:doppler_effect} Geometry associated to Doppler Effect.}
  \end {center}
\end {figure}


Consider a light source fixed to an inertial frame $S'$ moving with velocity $v$ 
w.r.t. an observer fixed to an inertial frame $S$ (see Figure 
\ref{fig:doppler_effect}). Suppose that the direction of movement makes the angle 
$\theta$ w.r.t. direction to the observer. Let $\vc v = v\vu x$ and represent the 
wavefront towards the observer with phase angle
\begin {eqnarray}
    \phi(\vc x, t) = A\cos(\vc k\cdot\vc x - \omega t),
\end {eqnarray}
where the wave vector satisfies 
\begin {eqnarray}
    \vc k = k\cos\theta\:\vu x + k\sin\theta\:\vu y.
\end {eqnarray}
Substitution of $kx-\omega t = 0$ yields in vacuum $x = \omega t / k = ct$ and 
$k = \omega/c$.

The phase angle $\phi$ in the frames $S$ and $S'$ can be related by the Galilean
transformation
\begin {eqnarray}
    t &=& t' \\
    x &=& x' + vt \\
    y &=& y' \\
    z &=& z'
\end {eqnarray}
with the expansion 
\begin {eqnarray}
    \vc k\cdot\vc x - \omega t
    &=&
    kx \cos\theta + ky \sin\theta - \omega t 
    \\
    &=& 
    k(x' + vt) \cos\theta + ky \sin\theta - \omega t 
    \\
    &=& 
    kx'\cos\theta + ky'\sin\theta -\omega(1 -\beta\cos\theta)
    \\
    &=& 
    \vc k'\cdot\vc x' - \omega' t
\end {eqnarray}
Thus, we obtain the expression for \textbf{classical Doppler Effect}
\begin {eqnarray}
    \boxed{
        \quad
        \omega = \frac{\omega'}{1 - \beta\cos\theta},
        \quad
        \vc k' = \vc k.
        \quad
    }
\end {eqnarray}
In the relativistic case, we replace the Galilean transformation with the Lorentz 
transformation 
\begin {eqnarray}
    t &=& \gamma(t' + \beta x'/c) \\
    x &=& \gamma(x' + vt) \\
    y &=& y' \\
    z &=& z'.
\end {eqnarray}
Now we can expand 
\begin {eqnarray}
    \vc k\cdot\vc x - \omega t 
    &=& 
    k\gamma(x' + vt')\cos\theta + ky\sin\theta  - \omega\gamma(t' + \beta x'/c)
    \\
    &=& 
    \gamma (k\cos\theta - \omega\beta/c)x' 
    + 
    ky\sin\theta 
    - 
    \gamma(\omega - kv\cos\theta)) t'
    \\
    &=& 
    \gamma k (\cos\theta - \beta)x'
    +
    ky'\sin\theta 
    -
    \gamma\omega(1 - \beta\cos\theta)t'
    \\
    &=& 
    \vc k'\cdot\vc x' - \omega' t' 
\end {eqnarray}
and obtain the expression for \textbf{relativistic Doppler Effect}
\begin {eqnarray}
    \label{eq:doppler_relativistic}
    \boxed{
        \quad
        \omega = \frac{\omega'}{\gamma(1 - \beta\cos\theta)},
        \quad
        \vc k' = \gamma k(\cos\theta - \beta)\vu x 
        +
        k\sin\theta\vu y.
        \quad
    }
\end {eqnarray}
The transformation of the wave vector corresponds to the relativistic aberration 
correction. 

\subsection{Interpretation}
\subsubsection{Longitudal Doppler Effect}
The special cases relating to longitudal motion are depicted in Figure \ref{fig:redshift_blueshift}.
When $\theta = 180^\circ$ and $\theta = 0^\circ$, we can expand 
\begin {eqnarray}
    \frac{\omega}{\omega'}
    &=&
    \frac{1}{\gamma(1 + \beta)}
    =
    \frac{\sqrt{(1 + \beta)(1 - \beta)}}{1 + \beta}
    = 
    \sqrt{\frac{1 - \beta}{1 + \beta}} \leq 1
    \\
    \frac{\omega}{\omega'}
    &=&
    \frac{1}{\gamma(1 - \beta)}
    =
    \frac{\sqrt{(1 + \beta)(1 - \beta)}}{1 - \beta}
    = 
    \sqrt{\frac{1 + \beta}{1 - \beta}} \geq 1
\end {eqnarray}
respectively. 
\begin {figure}[h]
  \begin {center}
    \begin{tikzpicture}
        \draw[thick] (0, -2) -- (3, -2);
        \draw[thick] (0, -1) -- (3, -1);
        \draw[thick] (0, -2) -- (0, -1);
        \draw[thick] (3, -2) -- (3, -1);
        \draw[thick, ->] (3, -1.5) -- (5, -1.5);
        \draw[thick] (1.5, -1.5) node{Emitter ($S'$)};
        \draw[thick] (4.5, -1.2) node{$v$};
        \draw[thick] (4.1, -1.7) node{$\theta=0$};
        \draw[thick] (5.5, -1.5) ellipse (0.5 and 0.5);
        \fill[black] (5.25, -1.5) ellipse (0.10 and 0.15);
        \draw[thick] (5.25, -1.5) ellipse (0.175 and 0.25);
        \draw[thick] (7.5, -1.5) node{Observer ($S$)};

        \draw[thick] (0, 0) -- (3, 0);
        \draw[thick] (0, 1) -- (3, 1);
        \draw[thick] (0, 0) -- (0, 1);
        \draw[thick] (3, 0) -- (3, 1);
        \draw[thick, dotted] (0, 0.5) -- (-2, 0.5);
        \draw[thick] (4.5, 0.8) node{$v$};
        \draw[thick, ->] (3, 0.5) -- (5, 0.5);

        \draw[thick] (1.5, 0.5) node{Emitter ($S'$)};
        \draw[thick] (-0.9, 0.3) node{$\theta=180^\circ$};
        \draw[thick] (-2.5, 0.5) ellipse (0.5 and 0.5);
        \fill[black] (-2.25, 0.5) ellipse (0.10 and 0.15);
        \draw[thick] (-2.25, 0.5) ellipse (0.175 and 0.25);
        \draw[thick] (-4.5, 0.5) node{Observer ($S$)};
        \end {tikzpicture}
    \caption{\label{fig:redshift_blueshift} Geometry associated to maximal 
             redshift (top) and maximal blueshift (below).}
  \end {center}
\end {figure}
\subsubsection{Transverse Doppler Effect}
With transverse motion, it is necessary to take into account the influence of
aberration: The meaning of the direction of movement being at right angles to 
the vector between the observer and the source is dependent on the frame. 
Superficial analysis not taking aberration into account might suggest that a 
planet orbiting a star a perfectly circular orbit would experience Doppler 
redshift but in fact it will experience blueshift.

Substitution of $\theta = \pi/2$ to $(\ref{eq:doppler_relativistic})$ yields 
expression for transverse motion in $S$
\begin {eqnarray}
    \omega = \frac{\omega'}{\gamma} < \omega'
\end {eqnarray}
However, substitution of $\theta' = \pi/2$ yields $\beta = \cos\theta$ and 
an expression for transverse motion in $S'$
\begin {eqnarray}
    \omega = \frac{\omega'}{\gamma(1 - \beta^2)} = \gamma\omega' > \omega'.
\end {eqnarray}
That is, transverse motion from the viewpoint of the observer leads to a 
redshift and transverse motion from the viewpoint of the source leads to 
a blueshift. A planet orbiting a star on a circular orbit will experience 
Doppler blueshift of the starlight and a imaging satellite orbiting a planet 
will experience (Doppler) redshift (see Figure \ref{fig:doppler_transverse}).

\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \draw (7, 0) node{$\bullet$};
        \draw (7, 0.35) node{$\sun$};
        %\draw[thick] (0,0) circle (2);

        \draw[thick] (9.0, 0) ellipse (0.5 and 0.5);
        \fill[black] (8.75, 0) ellipse (0.10 and 0.15);
        \draw[thick] (8.75, 0) ellipse (0.175 and 0.25);
        \draw[thick] (10.75, 0) node{Observer ($S$)};
        \draw[thick] (7, -0.5) node{Source ($S'$)};
        \draw[thick] (9,0.5) arc (15:345:2);
        \draw[thick, ->] (9, 0.5) -- (9, 2);
        \draw[thick] (9.2, 1) node{$v$};

        \draw[thick] (0,0) circle (2);
        \draw[thick] (0.0, 0) ellipse (0.5 and 0.5);
        \fill[black] (0.25, 0) ellipse (0.10 and 0.15);
        \draw[thick] (0.25, 0) ellipse (0.175 and 0.25);
        \draw[thick] (2, 0) node{$\bullet$};
        \draw (1.65, 0) node{$\sun$};
        \draw[thick, ->] (2, 0.0) -- (2, 2);
        \draw[thick] (2.2, 1) node{$v$};
        \draw[thick] (0.0, -0.75) node{Observer ($S$)};
        \draw[thick] (3.25, 0.0) node{Source ($S'$)};

    \end {tikzpicture}
    \caption{\label{fig:doppler_transverse} Two examples of transverse motion:
    Transverse motion in $S$ resulting in redshift (left) and transverse motion 
    in $S'$ resulting in blueshift (right).}
  \end {center}
\end {figure}


\subsubsection{Boundary Between Redshift and Blueshift}
As shown previously, maximum blueshift and redshift are obtained at angles 
$\theta=0^\circ$ and $\theta=180^\circ$, respectively. The boundary w.r.t. 
values $\theta$ between redshift and blueshift occurs when $\omega=\omega'$
or equivalently 
\begin {eqnarray}
    \gamma(1 - \beta\cos\theta) = 1
    &\Leftrightarrow&
    \cos\theta = \frac{1}{\beta}\left(1 - \frac{1}{\gamma}\right).
\end {eqnarray}
The limit is depicted in Figure \ref{fig:doppler_limits}. When $\beta$ 
becomes larger, the region of blueshift gets smaller and converges to a 
dot when $\beta\to 1$. 
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.8\columnwidth] {fig/doppler_limits.eps}
     \caption{\label{fig:doppler_limits} Limit angle between redshift and blueshift.
     For positive and negative $\beta$, the value is the lower and upper limit, respectively 
     of the blueshift for $\theta$.}
  \end {center}
\end {figure} 

\newpage
\section{Human Perception}
\subsection{Perspective Projection}
\subsubsection{The Camera Frustrum}
\textbf{Perspective projection} can be seen as an idealized representation how a
camera or the human eye forms a two-dimensional image from light rays received from 
a three-dimensional scene. Lines-of-sight are considered to converge on a single point,
which is considered as the location of the camera. If the image is rectangular, all 
potentially visible points in the scene are inside an infinite pyramidal shape 
starting from camera position. Usually, the pyramid is truncated into a 
\textbf{camera frustrum} with \textbf{near and far planes} orthogonal to the pointing 
direction of the camera (see Figure \ref{fig:frustrum}) and all points outside the frustrum 
are discarded (\textbf{culling}). 

\begin {figure}[t]
  \begin {center}
    \begin{tikzpicture}
        \draw[thick, ->] (0, 0) -- (0, 3);
        \draw[thick, ->] (0, 0) -- (-1.5, -1.5);
        \draw[thick, ->] (0, 0) -- (7.5, 0);

        \draw[dashed] (0, 0) -- (8 - 1, 0 - 1 - 2);
        \draw[dashed] (0, 0) -- (8 - 1, 0 - 1 + 2);
        \draw[dashed] (0, 0) -- (8 + 1, 0 + 1 - 2);
        \draw[dashed] (0, 0) -- (8 + 1, 0 + 1 + 2);

        \draw[thick] (2 - 0.25, 0 - 0.25 - 0.5) -- (2 + 0.25, 0 + 0.25 - 0.5);
        \draw[thick] (2 - 0.25, 0 - 0.25 + 0.5) -- (2 + 0.25, 0 + 0.25 + 0.5);
        \draw[thick] (2 - 0.25, 0 - 0.25 - 0.5) -- (2 - 0.25, 0 - 0.25 + 0.5);
        \draw[thick] (2 + 0.25, 0 + 0.25 - 0.5) -- (2 + 0.25, 0 + 0.25 + 0.5);

        \draw[thick] (2 - 0.25, 0 - 0.25 - 0.5) -- (6 - 0.75, 0 - 0.75 - 1.5);
        \draw[thick] (2 - 0.25, 0 - 0.25 + 0.5) -- (6 - 0.75, 0 - 0.75 + 1.5);
        \draw[thick] (2 + 0.25, 0 + 0.25 - 0.5) -- (6 + 0.75, 0 + 0.75 - 1.5);
        \draw[thick] (2 + 0.25, 0 + 0.25 + 0.5) -- (6 + 0.75, 0 + 0.75 + 1.5);

        \draw[thick] (6 - 0.75, 0 - 0.75 - 1.5) -- (6 + 0.75, 0 + 0.75 - 1.5);
        \draw[thick] (6 - 0.75, 0 - 0.75 + 1.5) -- (6 + 0.75, 0 + 0.75 + 1.5);
        \draw[thick] (6 - 0.75, 0 - 0.75 - 1.5) -- (6 - 0.75, 0 - 0.75 + 1.5);
        \draw[thick] (6 + 0.75, 0 + 0.75 - 1.5) -- (6 + 0.75, 0 + 0.75 + 1.5);

        \draw[dashed] (2, 0) -- (2, 2.3);
        \draw[dashed] (6, 0) -- (6, 2.3);
        \draw (2, 2.5) node{$z_e=-n$};
        \draw (6, 2.5) node{$z_e=-f$};


        \draw (2, 0) node{$\bullet$};
        \draw (6, 0) node{$\bullet$};

        \draw (0.35,2.75) node{$y_e$};
        \draw (-1.5,-1.1) node{$x_e$};
        \draw (7.4,0.4) node{$-z_e$};
    \end {tikzpicture}
    \caption{\label{fig:frustrum} Infinite pyramid truncated into a camera frustrum by 
             near and far planes at $z_e=-n$ and $z_e=-f$, respectively.}
  \end {center}
\end {figure}


\subsubsection{Model, World and View Spaces}
Intuitively, the image can be considered to form on the near plane. However, any real-world 
software implementation typically involves a sequence of coordinate transformations 
between the world space and normalized device coordinates. In this document, we use 
standard OpenGL terms and conventions (see e.g. TBA). 

Specific objects (e.g. cubes) in a scene might have their geometry defined in an object-specific
\textbf{local space}, where the object in question is typically placed at the origin. 
The actual scene inhabits a \textbf{world space} into which specific objects are placed 
according to object-specific mapping defined by a \textbf{model matrix}. Each camera is placed 
at the origin of the corresponding \textbf{view space} pointing to -z-direction and the 
camera-specific transformation from the world space is defined by a \textbf{view matrix}.
In the view space, the intersection of the frustrum and the near and far planes correspond to the sets
\begin {eqnarray}
    N &=&
    [l, r]\times[b, t]\times\{-n\} ,
    \\
    F &=&
    [fl/n, fr/n]\times[fb/n, ft/n]\times\{-f\},
\end {eqnarray}
where $l, r, b$ and $t$ refer to left, right, bottom and top coordinate values.

Since the transformations between spaces may involve translation in addition to deformation and 
rotation, 4x4-matrices operating on the Cartesian coordinates $(x,y,z,w)$ are used, where 
$w=1$ in local, world and view spaces. The translation part of such transformation is 
included in the last column as follows 
\begin {eqnarray}
    \begin {bmatrix}
        R_{11} & R_{12} & R_{13} & \Delta x \\
        R_{21} & R_{22} & R_{23} & \Delta y \\
        R_{31} & R_{32} & R_{33} & \Delta z \\
        0 & 0 & 0 & 1 
    \end {bmatrix}
    \begin {bmatrix}
        x \\ y \\ z \\ 1
    \end {bmatrix}
    = 
    \begin {bmatrix}
        R\vc r + \Delta\vc r \\ 1
    \end {bmatrix},
\end {eqnarray}
where we have denoted $\vc r = [x, y, z]^T$. Note that the matrix $R$ is not applied to 
the translation part and thus the translation is not a translation in the source coordinate system.
For example, if the camera is located at $(\vc p, 1)$ 
in the world space and points to $+z$-direction, the transformation between the world space 
coordinates $(x_w, y_w, z_w, w_w=1)$ to the view coordinates could be
\begin {eqnarray}
    \begin {bmatrix}
        x_e \\ y_e \\ z_e \\ w_e
    \end {bmatrix}
    = 
    \begin {bmatrix}
        -1 & 0 & 0 & p_x \\
        0 & 1 & 0 & -p_y \\
        0 & 0 & -1 & p_z \\
        0 & 0 & 0 & 1 
    \end {bmatrix}
    \begin {bmatrix}
        x_w \\ y_w \\ z_w \\ 1
    \end {bmatrix}
    = 
    \begin {bmatrix}
        -x_w + p_x \\ +y_w - p_y \\ -z_w + p_z \\ 1
    \end {bmatrix},
\end {eqnarray}
That is, the translation $(-p_x, -p_y, -p_z)$ in the world space corresponds to a translation 
$(p_x, -p_y, p_z)$ in the view space.

\subsubsection{The Clip Space, Projection and Normalized Device Coordinates}
In order to draw triangles, lines or points on a screen and clip anything outside the camera 
frustrum, the coordinates $(x_e, y_e, z_e, w_e = 1)$ from the view space are first 
transformed into a \textbf{clip space} with a \textbf{projection matrix}. Then, culling 
corresponds to discarding vertices with coordinates $(x_c, y_c, z_c, w_c)$ that satisfy
\begin {eqnarray}
    \label{eq:culling}
    \max\left\{|x_c|, |y_c|, |z_c|\right\} > w_c.
\end {eqnarray}
In the clip space $w_c$ does not necessarily equal to $1$. Rather, the clip space is 
an example of a \textbf{homogeneous space}, where the elements  
$(\alpha x_c, \alpha y_c, \alpha z_c, \alpha)$ are considered equal for all non-zero 
values of $\alpha$. After culling, the clip coordinates are therefore 
transformed to \textbf{normalized device coordinates} inside the cube 
$[-1, 1]\times[-1, 1]\times[-1, 1]$ with 
\begin {eqnarray}
    (x_n, y_n, z_n) = \left(x_c/w_c, y_c/w_c, z_c/w_c\right).
\end {eqnarray}

The projection matrix can be derived by first considering \textbf{projective plane coordinates}
on the near plane and their relation to the normalized device coordinates. If we denote 
coordinates in view space with $(x_e, y_e, z_e, w_e=1)$, the intersection between the line 
to the origin and the near plane is at 
\begin {eqnarray}
    x_p = \frac{nx_e}{-z_e}, \quad 
    y_p = \frac{ny_e}{-z_e}.
\end {eqnarray}
The normalized device coordinates $x_n, y_n$ on the near plane linearly map 
intervals $[l, r]$ and $[b, t]$ to the intervals $[-1, 1]$ and $[-1, 1]$.
Thus, we obtain 
\begin {eqnarray}
    x_n 
    &=&
    \frac{2x_p}{r - l} - \frac{r + l}{r - l},
    \\
    y_n 
    &=&
    \frac{2y_p}{t - b} - \frac{t + b}{t - b}.
\end {eqnarray}
Thus, selecting $w_c=-z_e$
\begin {eqnarray}
    x_n 
    &=& 
    \frac{1}{-z_e}\left(
        \frac{2nx_e}{r-l} + \frac{r+l}{r-l}z_e
    \right)
    =
    \frac{1}{w_e}\left(
        \frac{2nx_e}{r-l} + \frac{r+l}{r-l}z_e
    \right)
    =
    \frac{x_c}{w_e},
    \\
    y_n 
    &=& 
    \frac{1}{-z_e}\left(
        \frac{2ny_e}{t-b} + \frac{t+b}{t-b}z_e
    \right)
    =
    \frac{1}{w_e}\left(
        \frac{2ny_e}{t-b} + \frac{t+b}{t-b}z_e
    \right)
    =
    \frac{y_c}{w_e}.
\end {eqnarray}
We also want $z_n$ to obtain values in the interval $[-1, 1]$. Thus, requiring that 
a linear map $z_c = Az_e + B$ maps
$z_e = -n$ and $z_e = -f$ map to $z_c = -n$ and $z_c = f$, respectively, we get 
\begin {eqnarray}
    z_c 
    &=&
    -\frac{f+n}{f-n}z_e - \frac{2fn}{f-n}.
\end {eqnarray}
In order to check the result, we can compute the corresponding NDC coordinate
\begin {eqnarray}
    z_n 
    = 
    \frac{z_c}{-z_e}
    = 
    \frac{1}{f - n}\left(f + n + \frac{2fn}{z_e}\right).
\end {eqnarray}
Substituting $z_e = -n$ and $z_e = -f$ then yields $z_n=-1$ and $z_n=1$, respectively,
as expected.

Collecting the above results yields the projection matrix transforming the view 
coordinates to clip coordinates
\begin {eqnarray}
    \boxed {
        \quad
        P
        =
        \begin {bmatrix}
            2n/(r-l) & 0 & (r+l)/(r-l) & 0 \\
            0 & 2n/(t-b) & (t+b)/(t-b) & 0 \\
            0 & 0 & -(f+n)/(f-n) & -2fn/(f-n) \\
            0 & 0 & -1 & 0
        \end {bmatrix}.
        \quad
    }
\end {eqnarray}
In order to understand the culling criterion $(\ref{eq:culling})$, 
note that the projection matrix maps the intersection of each plane with constant $z_e$ 
with the camera frustrum to
\begin {eqnarray}
    [z_e, -z_e]\times [z_e, -z_e]\times\{z_c\}\times\{-z_e\}
    =
    [-w_c, w_c]\times [-w_c, w_c]\times\{z_c\}\times\{w_c\}.
\end {eqnarray}
Any point on the plane outside the frustrum will satisfy $(\ref{eq:culling})$.
On the other hand, if $z_c > w_c$, we get
\begin {eqnarray}
    z_c = -\frac{f + n}{f - n}z_e - \frac{2fn}{f - n} > w_c = - z_e 
\end {eqnarray}
from which it easily follows that $z_e < -f$. Similarly, if $z_c < - w_c$, we get
\begin {eqnarray}
    z_c = -\frac{f + n}{f - n}z_e - \frac{2fn}{f - n} < -w_c = z_e,
\end {eqnarray}
which yields $z_c > -n$.
\subsubsection{Special Cases of a Projection Matrix}
\begin {specialcase}
(General symmetric case): $l=-w, r=w, b=-h, b=h$
\begin {eqnarray}
    \label{eq:proj_gensym}
    P
    =
    \begin {bmatrix}
        n/w & 0 & 0 & 0 \\
        0 & n/h & 0 & 0 \\
        0 & 0 & -(f+n)/(f-n) & -2fn/(f-n) \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}
\end {specialcase}
\begin {specialcase}
(General infinite case): $f\to\infty$
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        2n/(r-l) & 0 & (r+l)/(r-l) & 0 \\
        0 & 2n/(t-b) & (t+b)/(t-b) & 0 \\
        0 & 0 & -1 & -2n \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}
\end {specialcase}
\begin {specialcase}
(Top-right case): $l=0, r=w, b=0, t=h$
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        2n/w & 0 & 1 & 0 \\
        0 & 2n/h & 1 & 0 \\
        0 & 0 & -(f+n)/(f-n) & -2fn/(f-n) \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}
\end {specialcase}
\begin {specialcase}
(Symmetric infinite case): $f\to\infty, l=-w, r=w, b=-h, b=h$
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        n/w & 0 & 0 & 0 \\
        0 & n/h & 0 & 0 \\
        0 & 0 & -1 & -2n \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}
\end {specialcase}
\subsubsection{Field-of-View and Aspect Ratio}
In the general symmetric case $(\ref{eq:proj_gensym})$, the parameters 
$w$ and $h$ have a clear relationship to horizontal and vertical field-of-view
\begin {eqnarray}
    \tan\left(\frac{\textrm{FOV}_x}{2}\right) &=& \frac{w}{n}, \\
    \tan\left(\frac{\textrm{FOV}_y}{2}\right) &=& \frac{h}{n}.
\end {eqnarray}
The projection matrix can be then written 
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        \dfrac{1}{\tan(FOV_x/2)} & 0 & 0 & 0 \\
        0 & \dfrac{1}{\tan(FOV_y/2)} & 0 & 0 \\
        0 & 0 & -\dfrac{f+n}{f-n} & \dfrac{-2fn}{f-n} \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}
Typically $\textrm{FOV}_y$ is written as FOV and $\textrm{FOV}_x$ is expressed 
using \textbf{aspect ratio} $\alpha=w/h$. Thereafter,
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        \dfrac{1}{\alpha\tan(FOV/2)} & 0 & 0 & 0 \\
        0 & \dfrac{1}{\tan(FOV/2)} & 0 & 0 \\
        0 & 0 & -\dfrac{f+n}{f-n} & \dfrac{-2fn}{f-n} \\
        0 & 0 & -1 & 0
    \end {bmatrix},
\end {eqnarray}
which simplifies in the infinite case to
\begin {eqnarray}
    P
    =
    \begin {bmatrix}
        \dfrac{1}{\alpha\tan(FOV/2)} & 0 & 0 & 0 \\
        0 & \dfrac{1}{\tan(FOV/2)} & 0 & 0 \\
        0 & 0 & -1 & -2n \\
        0 & 0 & -1 & 0
    \end {bmatrix}.
\end {eqnarray}

\subsection{Human Perception of Color}
\subsubsection{Human Vision and LMS Color Space}
Human vision is limited to the wavelength range between 380 and 700 nm. The 
perception of color is based on three classes of cone cells on the retina.
Each type of cone cell has different \textbf{spectral sensitivity}. That is,
they are sensitive to different ranges of wavelengths. We can refer to the 
three classes according to their peak wavelength as long (L), medium (M) and 
short (S) with peaks at 560, 530 and 420 nm, respectively.

Let $S(\lambda)$ be the \textbf{spectral power distribution} 
($\textrm{W}/\textrm{m}^2/\textrm{nm}$) of the light received by the eye.
If $\overline L(\lambda), \overline M(\lambda), \overline S(\lambda)$ are 
cone response functions 
\begin {eqnarray}
    L &=& \int_0^\infty S(\lambda)\overline L(\lambda)\:d\lambda 
    \\
    M &=& \int_0^\infty S(\lambda)\overline M(\lambda)\:d\lambda 
    \\
    S &=& \int_0^\infty S(\lambda)\overline S(\lambda)\:d\lambda,
\end {eqnarray}
they are called \textbf{Color Matching Functions (CMFs)} for the 
\textbf{LMS Color Space}. The cone response functions are normalized 
so that their maxima are equal to unity (see Figure \ref{fig:lms_colormatch}).
The triplets $(L, M, S)$ obtained above are called the \textbf{tristimulus 
values}. Two different spectra resulting in the same tristimulus values are 
called \textbf{metamers}.

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.8\columnwidth] {fig/lms_colormatch.eps}
     \caption{\label{fig:lms_colormatch} LMS color-matching functions
     $\overline L(\lambda), \overline M(\lambda), \overline S(\lambda)$.}
  \end {center}
\end {figure} 


% TBA: https://en.wikipedia.org/wiki/CIE_1931_color_space
% TBA: https://en.wikipedia.org/wiki/LMS_color_space
% TBA: https://www.fourmilab.ch/documents/specrend


\subsubsection{CIE 1931 Color Spaces and sRGB Encoding \label{sec:srgb}}
We wish to convert spectrum to 8-bit sRGB values that can be rendered on 
computer displays. This can be achieved by the use of CIE XYZ color-matching
functions and then performing a conversion to SRGB and subsequent 
quantization.
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.8\columnwidth] {fig/cie_XYZ.eps}
     \caption{\label{fig:cie_XYZ_colormatch} The CIE XYZ color-matching functions
     $\overline X(\lambda), \overline Y(\lambda), \overline Z(\lambda)$.}
  \end {center}
\end {figure}
The XYZ color-matching functions are shown in Figure \ref{fig:cie_XYZ_colormatch}
and the corresponding tristimulus values are obtained via the inner products 
\begin {eqnarray}
    X &=& \int_0^\infty S(\lambda)\overline X(\lambda)\:d\lambda 
    \\
    Y &=& \int_0^\infty S(\lambda)\overline Y(\lambda)\:d\lambda 
    \\
    Z &=& \int_0^\infty S(\lambda)\overline Z(\lambda)\:d\lambda.
\end {eqnarray}
%\begin {eqnarray}
%    x &=& X / (X + Y + Z), \\
%    y &=& Y / (X + Y + Z), \\
%    z &=& Z / (X + Y + Z)
%\end {eqnarray}
%\begin {eqnarray}
%    z = 1 - (x + y).
%\end {eqnarray}
%\subsubsection{RGB Values and 8-Bit Encoding}
Then, linear sRGB values between in the interval $[0, 1]$ can be obtained via
the matrix product
\begin {eqnarray}
    \label{eq:sRGB}
    \begin {bmatrix}
        R_{sRGB} \\
        G_{sRGB} \\
        B_{sRGB} 
    \end {bmatrix}
    =
    \begin {bmatrix}
        3.2406255 & -1.5372080 & -0.4986286 \\
        -0.9689307 & 1.8757561 & 0.0415175 \\
        0.0557101 & -0.2040211 & 1.0569959         
    \end {bmatrix}
    \begin {bmatrix}
        X \\
        Y \\
        Z 
    \end {bmatrix}
\end {eqnarray}
and clipping values below $0$ and above $1$ to $0$ and $1$, respectively.
Before quantization, a "gamma" transfer function is applied
\begin {eqnarray}
    \label{eq:sRGB2}
    C_{sRGB}' &=& 
    \left\{
    \begin {array}{ll}
        %-1.055(-C_{sRGB})^{(1/2.4)} + 0.55, & C_{sRGB} < -0.0031308 \\
        12.92\:C_{sRGB}, & C_{sRGB} \leq 0.0031308 \\
        1.055(C_{sRGB})^{(1/2.4)} - 0.055, & C_{sRGB} > 0.0031308
    \end {array}
    \right.
\end {eqnarray}
where $C \in \{R, G, B\}$. Finally, the 8-bit quantized values are obtained via
\begin {eqnarray}
    \begin {bmatrix}
        R_{sRGB(8)} \\
        G_{sRGB(8)} \\
        B_{sRGB(8)}
    \end {bmatrix}
    =
    \textrm{round}
    \left(
        255
        \begin {bmatrix}
            R_{sRGB}' \\
            G_{sRGB}' \\
            B_{sRGB}' 
        \end {bmatrix}
    \right)
\end {eqnarray}


%\begin {eqnarray}
%    \begin {bmatrix}
%        Y_{sYCC}' \\
%        Cb_{sYCC}' \\
%        Cr_{sYCC}' 
%    \end {bmatrix}
%    =
%    \begin {bmatrix}
%        0.2990 & 0.5870 & 0.1440 \\
%        -0.1687 & -0.3313 & 0.5000 \\
%        0.5000 & -0.4187 & -0.0813
%    \end {bmatrix}
%    \begin {bmatrix}
%        R_{sRGB}' \\
%        G_{sRGB}' \\
%        B_{sRGB}' 
%    \end {bmatrix}
%\end {eqnarray}
%\begin {eqnarray}
%    Y_{sYCC(8)} &=& \textrm{round}
%    \left[
%        255\:Y_{sYCC}' 
%    \right]
%    \\
%    Cb_{sYCC(8)} &=& \textrm{round}
%    \left[
%        (255\:Cb_{sYCC}') + 128 
%    \right]
%    \\
%    Cr_{sYCC(8)} &=& \textrm{round}
%    \left[
%        (255\:Cr_{sYCC}') + 128 
%    \right]
%\end {eqnarray}

\subsubsection{Example: Visible Wavelength Range}
To compute sRGB values corresponding to the visible wavelength range, select
for each wavelength $\lambda'$
\begin {eqnarray}
    \label{eq:diracwavel}
    S(\lambda) := \frac{1}{2}\delta(\lambda - \lambda'),
\end {eqnarray}
where $\delta$ is the Dirac delta function. The factor is used to avoid 
saturation in cases where the linear sRGB values become larger than 1. Then, 
\begin {eqnarray}
    X &=& 
    \frac{1}{2}
    \int_0^\infty \delta(\lambda - \lambda')\overline X(\lambda)\:d\lambda 
    =
    \frac{1}{2}\overline X(\lambda'),
    \\
    Y &=& 
    \frac{1}{2}\int_0^\infty \delta(\lambda - \lambda')\overline Y(\lambda)\:d\lambda 
    =
    \frac{1}{2}\overline Y(\lambda'),
    \\
    Z &=& 
    \frac{1}{2}\int_0^\infty \delta(\lambda - \lambda')\overline Z(\lambda)\:d\lambda
    =
    \frac{1}{2}\overline Z(\lambda'),
\end {eqnarray}
and application of $(\ref{eq:sRGB})$ and $(\ref{eq:sRGB2})$ yield Figure \ref{fig:rgb}.
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.9\columnwidth] {fig/rgb.eps}
     \caption{\label{fig:rgb} RGB values obtained with $(\ref{eq:diracwavel})$ with and 
     without normalization.}
  \end {center}
\end {figure}

\section{Spectrum and Radiation}
\subsection{Basic Radiometry}
\subsubsection{Black-Body Radiance}
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.45\columnwidth] {fig/radiance.eps}
     \caption{\label{fig:radiance} Geometry associated to the definition of radiance.}
  \end {center}
\end {figure}
\textbf{Luminosity} (also called \textbf{radiant flux}) $L$ $(W)$ for a 
closed surface is an absolute measure of radiated electromagnetic energy 
per unit time. The luminosity of Sun is denoted $L_{\odot}$. 
\textbf{Radiance} for a source $L_e$ is the radiant flux from a given surface 
per unit projected area. That is, 
\begin {eqnarray}
    L_e 
    &=&
    \pdiff{}{\Omega}\pdiff{L}{A\cos\theta}
\end {eqnarray}
where $\Omega$ is the solid angle around the surface element $dA$, $A$ is 
the area on the source and $\theta\in[0, \pi/2]$ is the angle between the 
surface normal and the point on the unit sphere (see Figure \ref{fig:radiance}). 
Projection of an area element $dA$ to the direction $\theta$ w.r.t. surface 
normal is equal to $\cos\theta\:dA$.

\textbf{Spectral radiance} in frequency or wavelength are defined 
\begin {eqnarray}
    L_{e,\nu} := \pdiff{L_e}{\nu} 
    &\Leftrightarrow&
    L_e = \int_0^\infty L_{r,\nu}(\nu)\:d\nu
    \\
    L_{e,\lambda} := \pdiff{L_e}{\lambda} 
    &\Leftrightarrow&
    L_e = \int_0^\infty L_{r,\lambda}(\lambda)\:d\lambda,
\end {eqnarray}
respectively. 
Spectral radiance of a \textbf{black-body} can be written 
\begin{eqnarray}
    \label{eq:blackbody_specfreq}
    L_{e,\nu}(\nu) 
    &=&
    \frac{2h\nu^3}{c^2}
    \left[
        \exp\left({\frac{h\nu}{kT}}\right) - 1
    \right]^{-1}
    \\
    \label{eq:blackbody_specwave}
    L_{e,\lambda}(\lambda) 
    &=&
    \frac{2hc^2}{\lambda^5}
    \left[
        \exp\left({\frac{hc}{\lambda kT}}\right) - 1
    \right]^{-1},
\end{eqnarray} 
where 
$h=6.62607015\cdot 10^{-34}\:\textrm{J}\cdot\textrm{Hz}^{-1}$ is 
the \textbf{Planck's constant} and 
$k=1.380649\cdot{10}^{-23}\:\textrm{J}\cdot\textrm{K}^{-1}$ is the 
\textbf{Bolzmann constant}.
To obtain radiance, we integrate over all frequencies
\begin {eqnarray}
    L_e 
    &=&
    \frac{2h}{c^2}\int_0^\infty
    \frac{\nu^3\:d\nu}{\exp\left(\frac{h\nu}{kT}\right) - 1}
\end {eqnarray}
using the substitution $x=h\nu/kT$. Substituting correspondingly 
$\nu=kT/h\:x$ and $d\nu=kT/h\:dx$, we obtain 
\begin {eqnarray}
    L_e 
    =
    \frac{2h}{c^2}\left(\frac{kT}{h}\right)^4
    \int_0^\infty\frac{x^3\:dx}{e^x - 1}
    =
    \frac{2h}{c^2}\left(\frac{kT}{h}\right)^4 \Gamma(4)\zeta(4),
\end {eqnarray}
where $\Gamma$ and $\zeta$ are the Gamma and Riemann zeta functions.
Substitution of $\Gamma(4) = 6$ and $\zeta(4) = \pi^4/15$ yields 
\begin {eqnarray}
    \label{eq:blackbody_radiance}
    L_e 
    =
    \frac{2\:k^4\pi^4}{15\:h^3c^2}\:T^4.
\end {eqnarray}
To obtain the radiant flux, we integrate the radiance over a hemisphere
of solid angles and the entire surface 
\begin {eqnarray}
    L 
    &=&
    \oint_A\int_\Omega L_e(\vc r, \theta, \phi)\cos\theta\:d\Omega\:dA
\end {eqnarray}
where $\vc r$ is a point on the surface element $dA$. The computation of the 
integral is simplified by the intependence of radiance 
$(\ref{eq:blackbody_radiance})$ from $\theta$ and $\phi$. For solid angle,
we can expand $d\Omega = \sin\theta\:d\theta d\phi$. Thus, 
\begin {eqnarray}
    L 
    = 
    \oint_A L_e 
    \int_0^{2\pi}\int_0^{\pi/2}\sin\theta\cos\theta\:d\theta\:d\phi\:dA
    =
    \pi\oint_A L_e\:dA.
\end {eqnarray}
If $L_e$ is independent of position on the surface (e.g. due to equal 
temperature), we obtain 
\begin {eqnarray}
    L = \pi AL_e.
\end {eqnarray}
For a black-body, this yields the \textbf{Stefan-Boltzmann law}
\begin {eqnarray}
    \label{eq:boltzmann}
    L 
    =
    \pi A L_e
    =
    \frac{2}{15}\frac{k^4\pi^5}{h^3c^2}AT^4 
    =
    \sigma AT^4, 
\end {eqnarray}
where the \textbf{Stefan-Boltzmann constant}
\begin {eqnarray}
    \sigma = \frac{2k^4\pi^5}{15h^3c^2} 
    = 
    5.670374419\cdot 10^{-8}\:\textrm{W}\cdot\textrm{m}^{-2}\cdot \textrm{K}^{-4}.
\end {eqnarray}
\subsubsection{Wien's Displacement Law}
To obtain peak frequency of the black body radiance as a function of temperature,
we derivate $(\ref{eq:blackbody_specfreq})$ w.r.t. frequency
\begin{eqnarray}
    \pdiff{L_{e,\nu}}{\nu}
    =
    \frac{6h\nu^2}{c^2}
    \left[\exp\left(\frac{h\nu}{kT}\right) - 1\right]^{-1}
     - \frac{2h^2\nu^3}{c^2kT}\exp\left(\frac{h\nu}{kT}\right)
     \left[\exp\left(\frac{h\nu}{kT}\right) - 1\right]^{-2}
     = 0.
\end {eqnarray}
Substitution of $x=h\nu/kT$ yields 
\begin {eqnarray}
    x = 3(1 - e^{-x}),
\end {eqnarray}
which admits numerical solution
\begin {eqnarray}
    x = \frac{h\nu}{kT} \approx 2.821439372122078893
\end {eqnarray}
Thus, the black-body radiance obtains it's peak at the frequency
\begin {eqnarray}
    \nu_{peak} 
    &=& 
    \frac{kT}{h}x \approx 5.878925757646824946 T\cdot 10^{10}
    \:\textrm{Hz}\cdot\textrm{K}^{-1}
\end {eqnarray} 
To obtain peak wavelength of the black body radiance as a function of temperature,
we derivate $(\ref{eq:blackbody_specwave})$ w.r.t. wavelength
\begin {eqnarray}
    \pdiff{L_{e,\lambda}}{\lambda}
    =
    - \frac{10hc^2}{\lambda^6}
    \left[
        \exp\left(\frac{hc}{\lambda kT}\right) - 1
    \right]^{-1}
    +
    \frac{2h^2c^3}{\lambda^7kT}
    \exp\left(\frac{hc}{\lambda kT}\right)
    \left[
        \exp\left(\frac{hc}{\lambda kT}\right) - 1
    \right]^{-2}
    =
    0.
\end {eqnarray}
Substitution of $y=hc/\lambda kT$ yields 
\begin {eqnarray}
    y = 5(1 - e^{-y}),
\end {eqnarray}
which admits numerical solution
\begin {eqnarray}
    y = \frac{hc}{\lambda kT} \approx 4.965114231744276303.
\end {eqnarray}
Thus, the black-body radiance obtains it's peak at the wavelength 
\begin {eqnarray}
    \label{eq:wien}
    \lambda_{peak} 
    &=&
    \frac{hc}{ky} \frac{1}{T}  
    \approx 2.897771955 / T\cdot 10^{-3}\:\textrm{m}\cdot\textrm{K}.
\end {eqnarray}
The equation $(\ref{eq:wien})$ is called the \textbf{Wien's displacement law}
and is usually written in terms of the constant of proportionality $b=hc/ky$
called the \textbf{Wien's displacement constant}. Note that when the blackbody 
radiance is expressed as a function of wavelength and frequency, the peak occurs 
at a different frequency in the sense that we cannot transform between the peak 
wavelength and peak frequency with the relation $\lambda\nu = c$.

Three examples of black-body spectra are shown in Figure \ref{fig:blackbody_example}.
Substitution of $T = 4000\:\textrm{K}, 5000\:\textrm{K}$ and $6000\:\textrm{K}$ yields 
$\lambda_{max} = 724.44\:\textrm{nm}, 579.55\:\textrm{nm}$ and $482.96\:\textrm{nm}$, 
respectively. The increasing spectral radiance of the curves seems consistent with 
$(\ref{eq:boltzmann})$ since $5^4/4^4 \approx 2.44$ and $6^4/5^4 \approx 2.49$.
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.65\columnwidth] {fig/blackbody_example.eps}
     \caption{\label{fig:blackbody_example} Three examples of black-body spectra.}
  \end {center}
\end {figure}
\subsubsection{Effective Temperature and Color}
Visual perception of black-body as a function of its \textbf{effective temperature}
is easily obtained using the computation in section \ref{sec:srgb}. In 
Figure \ref{fig:effective_temperature}, SRGB values for black-bodies are displayed for a 
temperature range. The XYZ-values have been normalized before SRGB conversion by division 
with $\max\{X, Y, Z\}$.
\begin {figure}[h]
  \begin {center}
     \includegraphics [angle=0, width=0.9\columnwidth] {fig/effective_temperature.eps}
     \caption{\label{fig:effective_temperature} Visual perception of color for black-bodies at temperatures 
     between $800$ K and $12000$ K.}
  \end {center}
\end {figure}

\subsection{Lorentz Transformations}
\textcolor{red}{It's somewhat likely that portion of details in this section are 
wrong.}
\subsubsection{Plane Waves and Intensity}
\textbf{Intensity} $I$ associated to electromagnetic wave is the time-average of the 
\textbf{Poynting vector} $\vc S$. That is,
\begin {eqnarray}
    I = |\langle\vc S\rangle| = \frac{1}{\mu_0}|\langle\vc E\times\vc B\rangle|,
\end {eqnarray} 
where $\mu_0$ is the permeability of vacuum 
$\mu_0 = 1.25663706127\cdot 10^{-6}\:\textrm{N}\cdot\textrm{A}^{-2}$.
Suppose inertial frame $S'$ is moving in the +x direction w.r.t. inertial frame 
$S$ with velocity $v$. Then, the electric field $\vc E$ and the magnetic flux 
density $\vc B$ vectors transform \cite{griffiths}
\begin {eqnarray}
\label{eq:lorentz_plane1}
\vc E_{||}'    &=& \vc E_{||}, \\
\vc E_{\perp}' &=& \gamma\left(\vc E_{\perp} + \vc v\times\vc B\right), \\
\vc B_{||}'    &=& \vc B_{||}, \\
\label{eq:lorentz_plane4}
\vc B_{\perp}' &=& \gamma\left(\vc B_{\perp} - \frac{1}{c^2}\vc v\times\vc E\right), 
\end {eqnarray}
where we have used $||$ and $\perp$ to denote components parallel and perpendicular 
to the motion. The velocity can be expressed $\vc v = v\vu x$.

Consider a linearly polarized plane wave solution with propagation direction 
at an angle $\theta$ w.r.t. $\vc v$:
\begin {eqnarray}
    \vc E &=& E_0 \left(
        \cos\theta\:\vu y + \sin\theta\:\vu x
    \right),
    \\
    \vc B &=& E_0/c\:\vu z,
\end {eqnarray}
where we have left out the $\cos(\vc k\cdot\vc r - \omega t + \delta)$ for brevity.
Application of the Lorentz transformation 
$(\ref{eq:lorentz_plane1})$-$(\ref{eq:lorentz_plane4})$ yields the fields in $S'$:
\begin {eqnarray}
    \vc E_{\perp}'
    &=&
    \gamma E_0\left(
        \cos\theta - \beta
    \right)\vu y,
    \\
    \vc E_{||}' 
    &=&  
    E_0\sin\theta\:\vu x,
    \\
    \vc B_{\perp}'
    &=&
    \gamma E_0/c\:\left(
        1 - \beta\cos\theta
    \right)\vu z,
    \\
    \vc B_{||}'
    &=&
    0.
\end {eqnarray}
Now the Poynting vector can be computed 
\begin {eqnarray}
    \frac{1}{\mu_0}\vc E'\times\vc B'
    &=&
    \frac{1}{\mu_0}
    \vc E_{||}'\times\vc B_{\perp}' + \frac{1}{\mu_0}\vc E_{\perp}'\times\vc B_{\perp}'
    \\
    &=&
    \frac{E_0^2}{\mu_0}
    (1 - \beta\cos\theta)
    \left\{
    \left(\sin\theta\:\vu x\right)
    \times 
    \left(
        \frac{\gamma}{c}\:\vu z
    \right)
    +
    \left[
        \gamma(\cos\theta - \beta)\vu y
    \right]
    \times 
    \left(
        \frac{\gamma}{c}\vu z
    \right)
    \right\}
    \\
    &=&
    \frac{E_0^2\gamma}{c\mu_0}
    (1 - \beta\cos\theta)
    \left[
        -\sin\theta\:\vu y 
        + 
        \gamma(\cos\theta - \beta)\:\vu z
    \right].
    \label{eq:poynting_plane}
\end {eqnarray}
Squaring the expression in square brackets yields 
\begin {eqnarray}
    \sin^2\theta + \frac{\cos^2\theta - 2\beta\cos\theta + \beta^2}{1 - \beta^2}
    &=&
    \frac{\sin^2\theta - \beta^2\sin^2\theta + \cos^2\theta - 2\beta\cos\theta + \beta^2}{1 - \beta^2}
    \\
    &=& 
    \gamma^2(
        1 - 2\beta\cos\theta + \beta^2\cos^2\theta
    )
    \\
    &=& 
    \gamma^2(1 - \beta\cos\theta)^2.
\end {eqnarray}
Substitution back to $(\ref{eq:poynting_plane})$ and application of 
$(\ref{eq:doppler_relativistic})$, yields
\begin {eqnarray}
    \frac{1}{\mu_0}|\vc E'\times\vc B'|
    =
    \frac{E_0^2\gamma^2}{c\mu_0}(1 - \beta\cos\theta)^2
    = 
    \left(\frac{\omega'}{\omega}\right)^2 
    \frac{1}{\mu_0}|\vc E\times\vc B|
\end {eqnarray}
Thus, the intensity of plane waves transforms between frames proportionally to the 
square of frequency, where the frequency ratio follows from the equation 
$(\ref{eq:doppler_relativistic})$ for the relativistic Doppler effect:
\begin {eqnarray}
    \label{eq:intensity_transform}
    \boxed{
    \quad
    \frac{I'}{I}
    =
    \left(
    \frac{\omega'}{\omega}
    \right)^2
    = 
    \gamma^2(1 - \beta\cos\theta)^2
    .
    \quad
    }
\end {eqnarray}

\subsubsection{Wave Four-Vector}
Consider again a plane wave in $S$ propagating to a direction that makes the angle 
$\theta$ with the +x direction in $S$. Then, if the frame $S'$ moves with velocity 
$v$ into the +x direction w.r.t. $S$, the wave four-vectors 
\begin {eqnarray}
    k &=& (\omega/c, k\cos\theta, k\sin\theta, 0), \\
    k' &=& (\omega'/c, k'\cos \theta', k'\sin\theta, 0)
\end {eqnarray}
in $S$ and $S'$ can be related by the inverse Lorentz transformation \cite{steane}
\begin {eqnarray}
    \label{eq:wavevec_four}
    \begin {bmatrix}
        \omega/c \\ k\cos\theta \\ k\sin\theta \\ 0
    \end {bmatrix}
    =
    \begin {bmatrix}
        \gamma & \gamma\beta & 0 & 0 \\
        \gamma\beta & \gamma & 0 & 0 \\
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1
    \end {bmatrix}
    \begin {bmatrix}
        \omega'/c \\ k'\cos\theta' \\ k'\sin\theta' \\ 0
    \end {bmatrix}
    =
    \begin {bmatrix}
        \gamma(\omega'/c + \beta k'\cos\theta') \\
        \gamma(\beta\omega'/c + k'\cos\theta') \\
        k'\sin\theta' \\
        0
    \end {bmatrix}.
\end {eqnarray}
This transformation is a treasure trove of useful information: The first row implies
\begin {eqnarray}
    \omega = \gamma(\omega' + \beta k'c\cos\theta') = \gamma\omega'(1 + \beta\cos\theta'),
\end {eqnarray}
which is equivalent to the relativistic Doppler effect in $(\ref{eq:doppler_relativistic})$.
The ratio of the third and second rows can be expanded 
\begin {eqnarray}
    \tan\theta 
    =
    \frac{k'\sin\theta'}{\gamma(\beta\omega'/c + k'\cos\theta')}
    =
    \frac{\sin\theta'}{\gamma(\cos\theta' + \beta)}
    = 
    \frac{\tan\theta'}{\gamma(1 + \beta\sec\theta')},
\end {eqnarray}
which is the relativistic aberration formula $(\ref{eq:relativistic_aberration})$.
The third row is equivalent to the y-component of $(\ref{eq:doppler_relativistic})$ for 
the wave vector and by using the relation $k = \omega/c$ can be converted into an another 
useful relation
\begin {eqnarray}
    \label{eq:useful_relation}
    \omega\sin\theta = \omega'\sin\theta'.
\end {eqnarray}
The ratio of the second and first rows also yields the relation 
\begin {eqnarray}
    \label{eq:klorentz3}
    \cos\theta 
    = 
    \frac{\beta\omega'/c + k'\cos\theta'}{\omega'/c + \beta k'\cos\theta'}
    = 
    \frac{\cos\theta' + \beta}{1 + \beta\cos\theta'}.
\end {eqnarray}


\subsubsection{Headlight Effect for Monochromatic Waves}
Consider monochromatic radiation source fixed in $S'$ that radiates with equal power to 
all directions. Suppose again also that the $S'$ moves w.r.t. $S$ to +x direction with 
velocity $v$. Let $\theta'$ be the angle in $S'$ w.r.t. direction of velocity. We want 
to find the dependence of radiated power density in $S$ on the angle $\theta$ and the 
solid angle $\Omega$. The luminosity is dependent of the frame. In fact, it diverges 
towards infinity as the speed of the source w.r.t. observer converges towards the 
speed of light. However, if the source emits a (large) fixed number $N$ of particles 
uniformly to all direction over some specific period, it makes sense to ask what is 
the dependence of the density of expected number of particles on $\theta$ and $\Omega$.

The number of particles per unit angle to the directions 
$(\theta', \theta' + d\theta')$ can be written
\begin {eqnarray}
    \label{eq:Lthetadot}
    \diff{N}{\theta'} 
    = 
    N \frac{2\pi r\sin\theta'}{4\pi r^2} r
    = 
    \frac{N}{2}\sin\theta'.
\end {eqnarray}
Now, we want to find an expression for the expected number of particles per unit 
angle in $S$. 
By chain rule, this should be equal to 
\begin {eqnarray}
    \diff{N}{\theta} = \diff{N}{\theta'}\diff{\theta'}{\theta}.
\end {eqnarray}
From $(\ref{eq:klorentz3})$, we can solve 
\begin {eqnarray}
    \cos\theta' = \frac{\cos\theta - \beta}{1 - \beta\cos\theta}.
\end {eqnarray}
Differentiating w.r.t. $\theta$, yields 
\begin {eqnarray}
    -\sin\theta'
    \diff{\theta'}{\theta}
    &=&
    \frac{-\sin\theta(1 - \beta\cos\theta) - (\cos\theta - \beta)\beta\sin\theta}
    {(1 - \beta\cos\theta)^2}
    \\
    &=&
    \frac{-\sin\theta + \beta\sin\theta\cos\theta - \beta\sin\theta\cos\theta + \beta^2\sin\theta}
    {(1 - \beta\cos\theta)^2}
    \\
    &=& 
    \frac{-\sin\theta(1 - \beta^2)}
    {(1 - \beta\cos\theta)^2}.
\end {eqnarray}
Thus, we obtain 
\begin {eqnarray}
    \diff{\theta'}{\theta}
    =
    \frac{\sin\theta}{\sin\theta'}\frac{1 - \beta^2}{(1 - \beta\cos\theta)^2}
\end {eqnarray}
Combination with $(\ref{eq:Lthetadot})$, yields
\begin {eqnarray}
    \diff{N}{\theta}
    =
    \diff{N}{\theta'}\diff{\theta'}{\theta}
    =
    \frac{N}{2}\sin\theta\frac{1 - \beta^2}{(1 - \beta\cos\theta)^2}.
\end {eqnarray}
In $S'$ the number of particles per solid angle is uniformly
\begin {eqnarray}
    \diff{N}{\Omega'} = \frac{N}{4\pi},
\end {eqnarray}
where $4\pi$ is the solid angle of the entire sphere.
To obtain corresponding expression w.r.t. $\Omega$, we first note the relationship
between solid angles and $\theta$
\begin {eqnarray}
    \diff{\theta}{\Omega} = \frac{1}{2\pi\sin\theta}.
\end {eqnarray}
Application of the chain rule now yields 
\begin {eqnarray}
    \diff{N}{\Omega}
    =
    \diff{N}{\theta}\diff{\theta}{\Omega}
    =
    \frac{N}{2}\sin\theta\frac{1-\beta^2}{(1-\beta\cos\theta)^2}
    \frac{1}{2\pi\sin\theta}
    = 
    \frac{N}{4\pi}\frac{1}{\gamma^2(1 - \beta\cos\theta)^2}
\end {eqnarray}
and application of relativistic Doppler effect $(\ref{eq:doppler_relativistic})$
leads to the desired result
\begin {eqnarray}
    \boxed{
        \quad
        \diff{N}{\Omega}
        = 
        \frac{N}{4\pi}
        \left(\frac{\omega}{\omega'}\right)^2
        =
        \left(\frac{\omega}{\omega'}\right)^2
        \diff{N}{\Omega'}
        \quad
    }
\end {eqnarray}
That is, the number of particles per unit solid angle transforms according to the 
squared ratio of frequencies from the relativistic Doppler effect. However, note 
that this derivation didn't involve EM radiation to which one could associate 
frequency. To obtain a transformation for the radiated power density per unit solid 
angle, we can use the relationship $(\ref{eq:intensity_transform})$ for the intensity 
of plane waves in the two frames. If the preceding argument describes the "number" 
of plane waves associated to specific power the intensity relates the power of 
each plane wave. 

This suggests that power density w.r.t. solid angle satisfies 
\begin {eqnarray}
    \boxed{
        \quad
        \diff{L}{\Omega} = \left(
            \frac{\omega}{\omega'}
        \right)^4 
        \diff{L'}{\Omega'}.
        \quad
    }
\end {eqnarray}


\subsubsection{Black-Body Radiance}
For an observer moving at relativistic speeds, the perceived color of black-body sources
can be significantly influenced by the Doppler effect. However, since the black-body 
radiation is not monochromatic but consists of a continuous spectrum, the computation
of the Doppler effect is no longer trivial. In a continuous spectrum, we do not 
expect a radiance that transforms proportionally to fourth power of the frequency:
If the Doppler effect indicates a ratio $\omega/\omega'$ ratio of frequencies between 
$S$ and $S'$ spectrum in the range $[\omega', \omega' + \Delta']$ in $S'$ will 
correspond to spectrum in the range $[\omega, \omega + (\omega/\omega')\Delta']$ in $S$. 
This suggests that radiance transforms instead to the third power.

In $S'$, we have spectral radiance
\begin {eqnarray}
    L_{e, \nu'}(\nu') 
    = 
    \frac{2h{\nu'}^3}{c^2}
    \left[
        \exp\left(\frac{h\nu'}{kT'}\right) - 1
    \right]^{-1}.
\end {eqnarray}
From superficial interpration of \cite{blackbody_doppler}, \cite{blackbody_doppler2},
it seems that the argument to the exponential term transforms according to an 
\textbf{effective temperature} so that 
\begin {eqnarray}
    \label{eq:effective_temperature_doppler}
    T = \frac{T'}{\gamma(1 - \beta\cos\theta)} 
    = 
    \left(\frac{\omega}{\omega'}\right)T'.
\end {eqnarray}
The amplitude term is replaced with one with third power of the Doppler-transformed 
frequency.
\subsection{Stars}
\subsubsection{Spectrum of Stars}
The electromagnetic spectrum of stars essentially follow the blackbody spectrum 
complicated slightly by absorption and emission lines. However, for visual 
effects discussed in this section, they can be approximated as ideal black-bodies.
Spectral classification of the star essentially determines to the selection of an
\textbf{effective temperature} $T_{eff}'$ used for the black-body spectrum in the 
rest frame of the star. 
%This effective temperature is further transformed based on the relativistic 
%Doppler effect using $(\ref{eq:effective_temperature_doppler})$.

\subsubsection{Observed Color}
To compute the color of a distant star observed by an observer in relative motion, 
we simply compute the effective temperature $T_{eff}$ of the star in the frame 
of the observer using $(\ref{eq:effective_temperature_doppler})$. When the observer 
is travelling directly towards the star in longitudal motion, this corresponds to the 
selection of $\theta=0$. Figure \ref{fig:blackbody_long_doppler} shows the observed 
color for a range of effective temperatures (in $S'$) for an observer moving 
with velocity $\beta$. Figure \ref{fig:blackbody_sun_doppler} shows the observed 
color for a range of angles $\theta$ w.r.t. the direction of motion for a black-body 
with the effective temperature $T'=5778$ K of the Sun. 


\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.65\columnwidth, viewport=30 0 410 330, clip=true] {fig/blackbody_long_doppler.eps}
     \caption{\label{fig:blackbody_long_doppler} Observed color of a black-body with 
     given effective temperature for an observer in longitudal motion w.r.t. source.}
  \end {center}
\end {figure} 
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=1.0\columnwidth, viewport=60 0 600 270, clip=true] {fig/blackbody_sun_doppler.eps}
     \caption{\label{fig:blackbody_sun_doppler} Observed color of a black-body 
     approximating the Sun at an angle $\theta$ w.r.t. the direction of motion.}
  \end {center}
\end {figure} 

\subsubsection{Observed Spectral Power Distribution}

\newpage

\section{Visual Effects at Relativistic Speeds}
\subsection{Deformation}
\subsubsection{Spherical Grid}
Consider spherical grid with $10^\circ$ steps w.r.t. coordinates
$\theta\in[-90^\circ, 90^\circ]$ and $\phi\in[-180^\circ, 180^\circ]$, 
where the relationship to Cartesian coordinates can be expressed as
\begin {eqnarray}
    x &=& R\cos\theta\cos\phi, \\
    y &=& R\cos\theta\sin\phi, \\
    z &=& R\sin\theta.
\end {eqnarray}
The radius $R$ is assumed to be so large that the uncorrected directions 
towards the grid do not change and discussion of acceleration in the following 
makes sense.

Application of the relativistic aberration correction $(\ref{eq:properdir2})$ 
to the grid with movement in $+x$ and $+z$ directions is shown Figure 
\ref{fig:sph_grid_deform_360_x}
and Figure 
\ref{fig:sph_grid_deform_360_z}, respectively.
Figure \ref{fig:sph_grid_perspective_x} and Figure \ref{fig:sph_grid_perspective_z} 
show the deformation for an observer with $90^\circ$ field-of-view. 
The comparison of the figures for motion in +x and +z directions indicates how the 
selection of the axis pointing to the north pole in spherical coordinates influences 
the simplicity of effect: When the motion is towards a pole, the effect becomes 
independent of $\phi$.

These visualizations show how as the observer accelerates towards the speed of light,
aberration corresponds to an increasing compression towards the direction of motion 
and stretching in the opposite direction. That is, towards the direction 
of motion, the angular size of light sources will decrease and create an impression
that the light sources are moving away from the observer while light sources 
in the opposite direction will appear to move towards the observer. 

If an observer launched into a direction normal to the galactic plane and 
accelerated towards the speed of light, they would observe the galaxy as a 
shrinking ring in the direction of movement. Similarly, if an observer launched 
from the pole of Saturn at near the speed of light, they would see Saturn's rings 
in the forward direction (for a very brief moment). One could find an 
time-dependent acceleration that ensures that rings of Saturn would be observed 
within given angle w.r.t. forward-direction.

\subsubsection{Rectangular Grid}
For rectangular grid on a $z=$constant plane, the angular size of the plane can be 
computed from $(\ref{eq:relativistic_aberration})$ by first rewriting 
\begin {eqnarray}
    \tan\theta' 
    = 
    \frac{\tan\theta}{\gamma(1 + \beta\sec\theta)}
    =
    \frac{\sin\theta/\cos\theta}{\gamma(1 + \beta/\cos\theta)}
    =
    \frac{\sin\theta}{\gamma(\cos\theta + \beta)}.
\end {eqnarray}
Substitution of $\theta=90^\circ$ then yields 
\begin {eqnarray}
    \label{eq:plane_aberration_limit}
    \theta' = \arctan\frac{1}{\gamma\beta}
\end {eqnarray}
In Figures \ref{fig:rectangular_grid_z}, $z=$constant grid is drawn together with the limiting curve 
$(\ref{eq:plane_aberration_limit})$ also shown in Figure \ref{fig:plane_aberration_limit}.
Figures \ref{fig:rectangular_grid_y} shows $y=$constant grid.

\newgeometry{left=1cm,bottom=0.1cm,top=0.1cm,right=1cm}
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_x_1.eps}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_x_2.eps}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_x_3.eps}
     \caption{\label{fig:sph_grid_deform_360_x}Deformation of a spherical grid due to motion in $+x$ direction.}
  \end {center}
\end {figure} 

\newpage

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_z_1.eps}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_z_2.eps}
     \includegraphics [angle=0, width=0.8\columnwidth, clip=true, viewport=70 20 920 530] {fig/spherical_grid_360_z_3.eps}
     \caption{\label{fig:sph_grid_deform_360_z}Deformation of a spherical grid due to motion in $+z$ direction.}
  \end {center}
\end {figure} 

\newpage

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=1.00\columnwidth, clip=true, viewport=70 160 1100 1600] {fig/spherical_grid_perspective_x.eps}
     \caption{\label{fig:sph_grid_perspective_x}Deformation of a spherical grid due to motion in $+x$ direction with perspective projection.}
  \end {center}
\end {figure} 

\newpage

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=1.00\columnwidth, clip=true, viewport=70 160 1100 1600] {fig/spherical_grid_perspective_z.eps}
     \caption{\label{fig:sph_grid_perspective_z}Deformation of a spherical grid due to motion in $+z$ direction with perspective projection.}
  \end {center}
\end {figure} 

\newpage
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.9\columnwidth, clip=true, viewport=70 100 1100 1100] {fig/rectangular_grid_z.eps}
     \caption{\label{fig:rectangular_grid_z}Deformation of a $z=$constant rectangular grid due to motion in $+z$ direction with perspective projection.}
  \end {center}
\end {figure} 
\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.60\columnwidth, viewport=25 15 465 150] {fig/plane_aberration_limit.eps}
     \caption{\label{fig:plane_aberration_limit}Angular radius of the circle into which 
     the infinite plane with $z=$constant is aberrated into.}
  \end {center}
\end {figure} 


\newpage

\begin {figure}
  \begin {center}
     \includegraphics [angle=0, width=0.9\columnwidth, clip=true, viewport=70 100 1100 1100] {fig/rectangular_grid_y.eps}
     \caption{\label{fig:rectangular_grid_y}Deformation of a $y=$constant rectangular grid due to motion in $+z$ direction with perspective projection.}
  \end {center}
\end {figure} 


\newpage

\restoregeometry


\subsubsection{Solid Objects}

\begin {thebibliography}{1}
    \bibitem{relativity_problems}
    Lightman, Press, Price, Teukolsky, Problem Book in Relativity and Gravitation, 
    Princeton University Press, 2017.
    \bibitem{almanac}
    Urban, Seidelmann, Explanatory Supplement to the Astronomical Alamanac, 
    3rd Edition, University Science Books, 2012.
    \bibitem{cie}
    CIE 1931 2-deg XYZ CMFs, Colour \& Vision Research Laboratory, 
    Institute of Opthalmology, University College London. Available at 
    \url{http://cvrl.ioo.ucl.ac.uk/cie.htm}.
    \bibitem{radiance}
    Walker, Saunders, Hattenburg, Spectral Radiance Calibrations, 
    NBS Special Publication 250-1, 1987.
    \bibitem{blackbody_doppler}
    Ford, O'Connell, Lorentz transformation of blackbody radiation, 
    Phys. Rev. E 88, 2013.
    \bibitem{blackbody_doppler2}
    Yurtsever, Wilkinson, Limits and Signatures of Relativistic Spaceflight,
    Acta Astronautica, Vol. 142, 2018
    \bibitem{griffiths}
    Griffiths, Introduction to Electrodynamics, 3rd Edition, Pearson, 2008.
    \bibitem{steane}
    Steane, Symmetry and Relativity, Lecture Notes, Oxford University, 2011.
    Available at \url{https://users.physics.ox.ac.uk/~Steane/teaching/lecture_course.html}.
\end {thebibliography}

\end {document}
